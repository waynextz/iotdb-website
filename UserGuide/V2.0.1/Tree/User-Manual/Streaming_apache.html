<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.19" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.66" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="alternate" hreflang="zh-cn" href="https://iotdb.apache.org/zh/UserGuide/V2.0.1/Tree/User-Manual/Streaming_apache.html"><meta property="og:url" content="https://iotdb.apache.org/UserGuide/V2.0.1/Tree/User-Manual/Streaming_apache.html"><meta property="og:site_name" content="IoTDB Website"><meta property="og:title" content="Stream Processing"><meta property="og:description" content="Stream Processing The IoTDB stream processing framework allows users to implement customized stream processing logic, which can monitor and capture storage engine changes, trans..."><meta property="og:type" content="article"><meta property="og:image" content="https://alioss.timecho.com/docs/img/1706778988482.jpg"><meta property="og:locale" content="en-US"><meta property="og:locale:alternate" content="zh-CN"><meta property="og:updated_time" content="2024-12-16T09:26:25.000Z"><meta property="article:modified_time" content="2024-12-16T09:26:25.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Stream Processing","image":["https://alioss.timecho.com/docs/img/1706778988482.jpg","https://alioss.timecho.com/docs/img/%E7%8A%B6%E6%80%81%E8%BF%81%E7%A7%BB%E5%9B%BE.png"],"dateModified":"2024-12-16T09:26:25.000Z","author":[]}</script><link rel="icon" href="/favicon.ico"><meta name="Description" content="Apache IoTDB: Time Series Database for IoT"><meta name="Keywords" content="TSDB, time series, time series database, IoTDB, IoT database, IoT data management, 时序数据库, 时间序列管理, IoTDB, 物联网数据库, 实时数据库, 物联网数据管理, 物联网数据"><meta name="baidu-site-verification" content="wfKETzB3OT"><meta name="google-site-verification" content="mZWAoRY0yj_HAr-s47zHCGHzx5Ju-RVm5wDbPnwQYFo"><script type="text/javascript">var _paq = window._paq = window._paq || [];
/* tracker methods like "setCustomDimension" should be called before "trackPageView" */
_paq.push(["setDoNotTrack", true]);
_paq.push(["disableCookies"]);
_paq.push(['trackPageView']);
_paq.push(['enableLinkTracking']);
(function() {
  var u="https://analytics.apache.org/";
  _paq.push(['setTrackerUrl', u+'matomo.php']);
  _paq.push(['setSiteId', '56']);
  var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
  g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
})();
</script><title>Stream Processing | IoTDB Website</title><meta name="description" content="Stream Processing The IoTDB stream processing framework allows users to implement customized stream processing logic, which can monitor and capture storage engine changes, trans...">
    <link rel="preload" href="/assets/style-B5GBuVeX.css" as="style"><link rel="stylesheet" href="/assets/style-B5GBuVeX.css">
    <link rel="modulepreload" href="/assets/app-D0_NMnAJ.js"><link rel="modulepreload" href="/assets/Streaming_apache.html-Y1LYADq5.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><!--[--><div class="theme-container no-sidebar external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="Take me home"><img class="vp-nav-logo" src="/logo.png" alt><!----><!----></a><!--]--></div><div class="vp-navbar-center"><!--[--><!--]--></div><div class="vp-navbar-end"><!--[--><!--[--><div id="docsearch-container" style="display:none;"></div><div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Documentation"><!--[--><!---->Documentation<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/UserGuide/latest/QuickStart/QuickStart_apache.html" aria-label="v1.3.3"><!---->v1.3.3<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/UserGuide/V1.3.0-2/QuickStart/QuickStart_apache.html" aria-label="v1.3.0/1/2"><!---->v1.3.0/1/2<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/UserGuide/V1.2.x/QuickStart/QuickStart.html" aria-label="v1.2.x"><!---->v1.2.x<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/UserGuide/V0.13.x/QuickStart/QuickStart.html" aria-label="v0.13.x"><!---->v0.13.x<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="auto-link external-link" href="https://cwiki.apache.org/confluence/display/IOTDB/System+Design" aria-label="Design" rel="noopener noreferrer" target="_blank"><!---->Design<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/Download/" aria-label="Download"><!---->Download<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Community"><!--[--><!---->Community<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/Community/About-the-Community.html" aria-label="About the Community"><!---->About the Community<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/Community/Development-Guide.html" aria-label="Development Guide"><!---->Development Guide<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/Community/Community-Partners.html" aria-label="Community Partners"><!---->Community Partners<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/Community/Communication-Channels.html" aria-label="Communication Channels"><!---->Communication Channels<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/Community/Events-and-Reports.html" aria-label="Events and Reports"><!---->Events and Reports<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/Community/Commiters.html" aria-label="Commiters"><!---->Commiters<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="ASF"><!--[--><!---->ASF<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://www.apache.org/" aria-label="Foundation" rel="noopener noreferrer" target="_blank"><!---->Foundation<!----></a></li><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://www.apache.org/licenses/" aria-label="License" rel="noopener noreferrer" target="_blank"><!---->License<!----></a></li><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://www.apache.org/security/" aria-label="Security" rel="noopener noreferrer" target="_blank"><!---->Security<!----></a></li><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://www.apache.org/foundation/sponsorship.html" aria-label="Sponsorship" rel="noopener noreferrer" target="_blank"><!---->Sponsorship<!----></a></li><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://www.apache.org/foundation/thanks.html" aria-label="Thanks" rel="noopener noreferrer" target="_blank"><!---->Thanks<!----></a></li><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://www.apache.org/events/current-event" aria-label="Current  Events" rel="noopener noreferrer" target="_blank"><!---->Current  Events<!----></a></li><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://privacy.apache.org/policies/privacy-policy-public.html" aria-label="Privacy" rel="noopener noreferrer" target="_blank"><!---->Privacy<!----></a></li></ul></button></div></div></nav><div class="vp-nav-item"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Select language"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" name="i18n" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/UserGuide/V2.0.1/Tree/User-Manual/Streaming_apache.html" aria-label="English"><!---->English<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/zh/UserGuide/V2.0.1/Tree/User-Manual/Streaming_apache.html" aria-label="简体中文"><!---->简体中文<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:none;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:block;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/apache/iotdb" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Stream Processing</h1><div class="page-info"><!----><!----><span class="page-date-info" aria-label="Writing Date📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">October 10, 2023</span><meta property="datePublished" content="2023-10-10T10:08:46.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 18 min</span><meta property="timeRequired" content="PT18M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc" vp-toc><!----><div class="vp-toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#custom-stream-processing-plugin-development">Custom Stream Processing Plugin Development</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#programming-development-dependencies">Programming development dependencies</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-driven-programming-model">Event-Driven Programming Model</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#custom-stream-processing-plugin-programming-interface-definition">Custom Stream Processing Plugin Programming Interface Definition</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#custom-stream-processing-plugin-management">Custom Stream Processing Plugin Management</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#load-plugin-statement">Load Plugin Statement</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#delete-plugin-statement">Delete Plugin Statement</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#show-plugin-statement">Show Plugin Statement</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#system-pre-installed-stream-processing-plugin">System Pre-installed Stream Processing Plugin</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#pre-built-source-plugin">Pre-built Source Plugin</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#pre-built-processor-plugin">Pre-built Processor Plugin</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#pre-built-sink-plugin">Pre-built Sink Plugin</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#stream-processing-task-management">Stream Processing Task Management</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#create-stream-processing-task">Create Stream Processing Task</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#start-stream-processing-task">Start Stream Processing Task</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#stop-stream-processing-task">Stop Stream Processing Task</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#delete-stream-processing-task">Delete Stream Processing Task</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#show-stream-processing-task">Show Stream Processing Task</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#stream-processing-task-running-status-migration">Stream Processing Task Running Status Migration</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#authority-management">Authority Management</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#stream-processing-task">Stream Processing Task</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#stream-processing-task-plugin">Stream Processing Task Plugin</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#configure-parameters">Configure Parameters</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content" vp-content><h1 id="stream-processing" tabindex="-1"><a class="header-anchor" href="#stream-processing"><span>Stream Processing</span></a></h1><p>The IoTDB stream processing framework allows users to implement customized stream processing logic, which can monitor and capture storage engine changes, transform changed data, and push transformed data outward.</p><p>We call <!---->. A stream processing task (Pipe) contains three subtasks:</p><ul><li>Source task</li><li>Processor task</li><li>Sink task</li></ul><p>The stream processing framework allows users to customize the processing logic of three subtasks using Java language and process data in a UDF-like manner.<br> In a Pipe, the three subtasks mentioned above are executed and implemented by three types of plugins. Data flows through these three plugins sequentially for processing:<br> Pipe Source is used to extract data, Pipe Processor is used to process data, Pipe Sink is used to send data, and the final data will be sent to an external system.</p><p><strong>The model for a Pipe task is as follows:</strong></p><figure><img src="https://alioss.timecho.com/docs/img/1706778988482.jpg" alt="pipe.png" tabindex="0" loading="lazy"><figcaption>pipe.png</figcaption></figure><p>A data stream processing task essentially describes the attributes of the Pipe Source, Pipe Processor, and Pipe Sink plugins.</p><p>Users can configure the specific attributes of these three subtasks declaratively using SQL statements. By combining different attributes, flexible data ETL (Extract, Transform, Load) capabilities can be achieved.</p><p>Using the stream processing framework, it is possible to build a complete data pipeline to fulfill various requirements such as <em>edge-to-cloud synchronization, remote disaster recovery, and read/write load balancing across multiple databases</em>.</p><h2 id="custom-stream-processing-plugin-development" tabindex="-1"><a class="header-anchor" href="#custom-stream-processing-plugin-development"><span>Custom Stream Processing Plugin Development</span></a></h2><h3 id="programming-development-dependencies" tabindex="-1"><a class="header-anchor" href="#programming-development-dependencies"><span>Programming development dependencies</span></a></h3><p>It is recommended to use Maven to build the project. Add the following dependencies in the <code>pom.xml</code> file. Please make sure to choose dependencies with the same version as the IoTDB server version.</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">dependency</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">groupId</span><span style="color:#ABB2BF;">&gt;org.apache.iotdb&lt;/</span><span style="color:#E06C75;">groupId</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">artifactId</span><span style="color:#ABB2BF;">&gt;pipe-api&lt;/</span><span style="color:#E06C75;">artifactId</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">version</span><span style="color:#ABB2BF;">&gt;1.3.1&lt;/</span><span style="color:#E06C75;">version</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">scope</span><span style="color:#ABB2BF;">&gt;provided&lt;/</span><span style="color:#E06C75;">scope</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">dependency</span><span style="color:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="event-driven-programming-model" tabindex="-1"><a class="header-anchor" href="#event-driven-programming-model"><span>Event-Driven Programming Model</span></a></h3><p>The design of user programming interfaces for stream processing plugins follows the principles of the event-driven programming model. In this model, events serve as the abstraction of data in the user programming interface. The programming interface is decoupled from the specific execution method, allowing the focus to be on describing how the system expects events (data) to be processed upon arrival.</p><p>In the user programming interface of stream processing plugins, events abstract the write operations of database data. Events are captured by the local stream processing engine and passed sequentially through the three stages of stream processing, namely Pipe Source, Pipe Processor, and Pipe Sink plugins. User logic is triggered and executed within these three plugins.</p><p>To accommodate both low-latency stream processing in low-load scenarios and high-throughput stream processing in high-load scenarios at the edge, the stream processing engine dynamically chooses the processing objects from operation logs and data files. Therefore, the user programming interface for stream processing requires the user to provide the handling logic for two types of events: TabletInsertionEvent for operation log write events and TsFileInsertionEvent for data file write events.</p><h4 id="tabletinsertionevent" tabindex="-1"><a class="header-anchor" href="#tabletinsertionevent"><span><strong>TabletInsertionEvent</strong></span></a></h4><p>The TabletInsertionEvent is a high-level data abstraction for user write requests, which provides the ability to manipulate the underlying data of the write request by providing a unified operation interface.</p><p>For different database deployments, the underlying storage structure corresponding to the operation log write event is different. For stand-alone deployment scenarios, the operation log write event is an encapsulation of write-ahead log (WAL) entries; for distributed deployment scenarios, the operation log write event is an encapsulation of individual node consensus protocol operation log entries.</p><p>For write operations generated by different write request interfaces of the database, the data structure of the request structure corresponding to the operation log write event is also different.IoTDB provides many write interfaces such as InsertRecord, InsertRecords, InsertTablet, InsertTablets, and so on, and each kind of write request uses a completely different serialisation method to generate a write request. completely different serialisation methods and generate different binary entries.</p><p>The existence of operation log write events provides users with a unified view of data operations, which shields the implementation differences of the underlying data structures, greatly reduces the programming threshold for users, and improves the ease of use of the functionality.</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">/** TabletInsertionEvent is used to define the event of data insertion. */</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#C678DD;"> interface</span><span style="color:#E5C07B;"> TabletInsertionEvent</span><span style="color:#C678DD;"> extends</span><span style="color:#E5C07B;"> Event</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * The consumer processes the data row by row and collects the results by RowCollector.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@return</span><span style="color:#7F848E;font-style:italic;"> {@code Iterable&lt;TabletInsertionEvent&gt;} a list of new TabletInsertionEvent contains the</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *     results collected by the RowCollector</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#E5C07B;">  Iterable</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">TabletInsertionEvent</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> processRowByRow</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">BiConsumer</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">Row</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">RowCollector</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">consumer</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * The consumer processes the Tablet directly and collects the results by RowCollector.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@return</span><span style="color:#7F848E;font-style:italic;"> {@code Iterable&lt;TabletInsertionEvent&gt;} a list of new TabletInsertionEvent contains the</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *     results collected by the RowCollector</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#E5C07B;">  Iterable</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">TabletInsertionEvent</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> processTablet</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">BiConsumer</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">Tablet</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">RowCollector</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">consumer</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="tsfileinsertionevent" tabindex="-1"><a class="header-anchor" href="#tsfileinsertionevent"><span><strong>TsFileInsertionEvent</strong></span></a></h4><p>The TsFileInsertionEvent represents a high-level abstraction of the database&#39;s disk flush operation and is a collection of multiple TabletInsertionEvents.</p><p>IoTDB&#39;s storage engine is based on the LSM (Log-Structured Merge) structure. When data is written, the write operations are first flushed to log-structured files, while the written data is also stored in memory. When the memory reaches its capacity limit, a flush operation is triggered, converting the data in memory into a database file while deleting the previously written log entries. During the conversion from memory data to database file data, two compression processes, encoding compression and universal compression, are applied. As a result, the data in the database file occupies less space compared to the original data in memory.</p><p>In extreme network conditions, directly transferring data files is more cost-effective than transmitting individual write operations. It consumes lower network bandwidth and achieves faster transmission speed. However, there is no such thing as a free lunch. Performing calculations on data in the disk file incurs additional costs for file I/O compared to performing calculations directly on data in memory. Nevertheless, the coexistence of disk data files and memory write operations permits dynamic trade-offs and adjustments. It is based on this observation that the data file write event is introduced into the event model of the plugin.</p><p>In summary, the data file write event appears in the event stream of stream processing plugins in the following two scenarios:</p><ol><li><p>Historical data extraction: Before a stream processing task starts, all persisted write data exists in the form of TsFiles. When collecting historical data at the beginning of a stream processing task, the historical data is abstracted as TsFileInsertionEvent.</p></li><li><p>Real-time data extraction: During the execution of a stream processing task, if the speed of processing the log entries representing real-time operations is slower than the rate of write requests, the unprocessed log entries will be persisted to disk in the form of TsFiles. When these data are extracted by the stream processing engine, they are abstracted as TsFileInsertionEvent.</p></li></ol><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * TsFileInsertionEvent is used to define the event of writing TsFile. Event data stores in disks,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * which is compressed and encoded, and requires IO cost for computational processing.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#C678DD;"> interface</span><span style="color:#E5C07B;"> TsFileInsertionEvent</span><span style="color:#C678DD;"> extends</span><span style="color:#E5C07B;"> Event</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * The method is used to convert the TsFileInsertionEvent into several TabletInsertionEvents.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@return</span><span style="color:#7F848E;font-style:italic;"> {@code Iterable&lt;TabletInsertionEvent&gt;} the list of TabletInsertionEvent</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#E5C07B;">  Iterable</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">TabletInsertionEvent</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> toTabletInsertionEvents</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="custom-stream-processing-plugin-programming-interface-definition" tabindex="-1"><a class="header-anchor" href="#custom-stream-processing-plugin-programming-interface-definition"><span>Custom Stream Processing Plugin Programming Interface Definition</span></a></h3><p>Based on the custom stream processing plugin programming interface, users can easily write data extraction plugins, data processing plugins, and data sending plugins, allowing the stream processing functionality to adapt flexibly to various industrial scenarios.</p><h4 id="data-extraction-plugin-interface" tabindex="-1"><a class="header-anchor" href="#data-extraction-plugin-interface"><span>Data Extraction Plugin Interface</span></a></h4><p>Data extraction is the first stage of the three-stage process of stream processing, which includes data extraction, data processing, and data sending. The data extraction plugin (PipeSource) serves as a bridge between the stream processing engine and the storage engine. It captures various data write events by listening to the behavior of the storage engine.</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * PipeSource</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * &lt;p&gt;PipeSource is responsible for capturing events from sources.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * &lt;p&gt;Various data sources can be supported by implementing different PipeSource classes.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * &lt;p&gt;The lifecycle of a PipeSource is as follows:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * &lt;ul&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *   &lt;li&gt;When a collaboration task is created, the KV pairs of `WITH SOURCE` clause in SQL are</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       parsed and the validation method {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeSource</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">validate(PipeParameterValidator)</span><span style="color:#7F848E;font-style:italic;">} will</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       be called to validate the parameters.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *   &lt;li&gt;Before the collaboration task starts, the method {@link</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       PipeSource#customize(PipeParameters, PipeSourceRuntimeConfiguration)} will be called to</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       config the runtime behavior of the PipeSource.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *   &lt;li&gt;Then the method {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeSource</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">start()</span><span style="color:#7F848E;font-style:italic;">} will be called to start the PipeSource.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *   &lt;li&gt;While the collaboration task is in progress, the method {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeSource</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">supply()</span><span style="color:#7F848E;font-style:italic;">} will be</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       called to capture events from sources and then the events will be passed to the</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       PipeProcessor.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *   &lt;li&gt;The method {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeSource</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">close()</span><span style="color:#7F848E;font-style:italic;">} will be called when the collaboration task is</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       cancelled (the `DROP PIPE` command is executed).</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * &lt;/ul&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#C678DD;"> interface</span><span style="color:#E5C07B;"> PipeSource</span><span style="color:#C678DD;"> extends</span><span style="color:#E5C07B;"> PipePlugin</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * This method is mainly used to validate {@link PipeParameters} and it is executed before {@link</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * PipeSource#customize(PipeParameters, PipeSourceRuntimeConfiguration)} is called.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E06C75;font-style:italic;"> validator</span><span style="color:#7F848E;font-style:italic;"> the validator used to validate {@link PipeParameters}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> Exception</span><span style="color:#7F848E;font-style:italic;"> if any parameter is not valid</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#C678DD;">  void</span><span style="color:#61AFEF;"> validate</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">PipeParameterValidator</span><span style="color:#E06C75;font-style:italic;"> validator</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * This method is mainly used to customize PipeSource. In this method, the user can do the</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * following things:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * &lt;ul&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *   &lt;li&gt;Use PipeParameters to parse key-value pair attributes entered by the user.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *   &lt;li&gt;Set the running configurations in PipeSourceRuntimeConfiguration.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * &lt;/ul&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * &lt;p&gt;This method is called after the method {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeSource</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">validate(PipeParameterValidator)</span><span style="color:#7F848E;font-style:italic;">}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * is called.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E06C75;font-style:italic;"> parameters</span><span style="color:#7F848E;font-style:italic;"> used to parse the input parameters entered by the user</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E06C75;font-style:italic;"> configuration</span><span style="color:#7F848E;font-style:italic;"> used to set the required properties of the running PipeSource</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> Exception</span><span style="color:#7F848E;font-style:italic;"> the user can throw errors if necessary</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#C678DD;">  void</span><span style="color:#61AFEF;"> customize</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">PipeParameters</span><span style="color:#E06C75;font-style:italic;"> parameters</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">PipeSourceRuntimeConfiguration</span><span style="color:#E06C75;font-style:italic;"> configuration</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">      throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * Start the source. After this method is called, events should be ready to be supplied by</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeSource</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">supply()</span><span style="color:#7F848E;font-style:italic;">}. This method is called after {@link</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * PipeSource#customize(PipeParameters, PipeSourceRuntimeConfiguration)} is called.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> Exception</span><span style="color:#7F848E;font-style:italic;"> the user can throw errors if necessary</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#C678DD;">  void</span><span style="color:#61AFEF;"> start</span><span style="color:#ABB2BF;">()</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * Supply single event from the source and the caller will send the event to the processor.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * This method is called after {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeSource</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">start()</span><span style="color:#7F848E;font-style:italic;">} is called.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@return</span><span style="color:#7F848E;font-style:italic;"> the event to be supplied. the event may be null if the source has no more events at</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *     the moment, but the source is still running for more events.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> Exception</span><span style="color:#7F848E;font-style:italic;"> the user can throw errors if necessary</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#E5C07B;">  Event</span><span style="color:#61AFEF;"> supply</span><span style="color:#ABB2BF;">()</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="data-processing-plugin-interface" tabindex="-1"><a class="header-anchor" href="#data-processing-plugin-interface"><span>Data Processing Plugin Interface</span></a></h4><p>Data processing is the second stage of the three-stage process of stream processing, which includes data extraction, data processing, and data sending. The data processing plugin (PipeProcessor) is primarily used for filtering and transforming the various events captured by the data extraction plugin (PipeSource).</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * PipeProcessor</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * &lt;p&gt;PipeProcessor is used to filter and transform the Event formed by the PipeSource.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * &lt;p&gt;The lifecycle of a PipeProcessor is as follows:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * &lt;ul&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *   &lt;li&gt;When a collaboration task is created, the KV pairs of `WITH PROCESSOR` clause in SQL are</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       parsed and the validation method {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeProcessor</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">validate(PipeParameterValidator)</span><span style="color:#7F848E;font-style:italic;">}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       will be called to validate the parameters.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *   &lt;li&gt;Before the collaboration task starts, the method {@link</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       PipeProcessor#customize(PipeParameters, PipeProcessorRuntimeConfiguration)} will be called</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       to config the runtime behavior of the PipeProcessor.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *   &lt;li&gt;While the collaboration task is in progress:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       &lt;ul&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *         &lt;li&gt;PipeSource captures the events and wraps them into three types of Event instances.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *         &lt;li&gt;PipeProcessor processes the event and then passes them to the PipeSink. The</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *             following 3 methods will be called: {@link</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *             PipeProcessor#process(TabletInsertionEvent, EventCollector)}, {@link</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *             PipeProcessor#process(TsFileInsertionEvent, EventCollector)} and {@link</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *             PipeProcessor#process(Event, EventCollector)}.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *         &lt;li&gt;PipeSink serializes the events into binaries and send them to sinks.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       &lt;/ul&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *   &lt;li&gt;When the collaboration task is cancelled (the `DROP PIPE` command is executed), the {@link</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       PipeProcessor#close() } method will be called.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * &lt;/ul&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#C678DD;"> interface</span><span style="color:#E5C07B;"> PipeProcessor</span><span style="color:#C678DD;"> extends</span><span style="color:#E5C07B;"> PipePlugin</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * This method is mainly used to validate {@link PipeParameters} and it is executed before {@link</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * PipeProcessor#customize(PipeParameters, PipeProcessorRuntimeConfiguration)} is called.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E06C75;font-style:italic;"> validator</span><span style="color:#7F848E;font-style:italic;"> the validator used to validate {@link PipeParameters}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> Exception</span><span style="color:#7F848E;font-style:italic;"> if any parameter is not valid</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#C678DD;">  void</span><span style="color:#61AFEF;"> validate</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">PipeParameterValidator</span><span style="color:#E06C75;font-style:italic;"> validator</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * This method is mainly used to customize PipeProcessor. In this method, the user can do the</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * following things:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * &lt;ul&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *   &lt;li&gt;Use PipeParameters to parse key-value pair attributes entered by the user.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *   &lt;li&gt;Set the running configurations in PipeProcessorRuntimeConfiguration.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * &lt;/ul&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * &lt;p&gt;This method is called after the method {@link</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * PipeProcessor#validate(PipeParameterValidator)} is called and before the beginning of the</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * events processing.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E06C75;font-style:italic;"> parameters</span><span style="color:#7F848E;font-style:italic;"> used to parse the input parameters entered by the user</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E06C75;font-style:italic;"> configuration</span><span style="color:#7F848E;font-style:italic;"> used to set the required properties of the running PipeProcessor</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> Exception</span><span style="color:#7F848E;font-style:italic;"> the user can throw errors if necessary</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#C678DD;">  void</span><span style="color:#61AFEF;"> customize</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">PipeParameters</span><span style="color:#E06C75;font-style:italic;"> parameters</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">PipeProcessorRuntimeConfiguration</span><span style="color:#E06C75;font-style:italic;"> configuration</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">      throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * This method is called to process the TabletInsertionEvent.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E06C75;font-style:italic;"> tabletInsertionEvent</span><span style="color:#7F848E;font-style:italic;"> TabletInsertionEvent to be processed</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E06C75;font-style:italic;"> eventCollector</span><span style="color:#7F848E;font-style:italic;"> used to collect result events after processing</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> Exception</span><span style="color:#7F848E;font-style:italic;"> the user can throw errors if necessary</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#C678DD;">  void</span><span style="color:#61AFEF;"> process</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">TabletInsertionEvent</span><span style="color:#E06C75;font-style:italic;"> tabletInsertionEvent</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">EventCollector</span><span style="color:#E06C75;font-style:italic;"> eventCollector</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">      throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * This method is called to process the TsFileInsertionEvent.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E06C75;font-style:italic;"> tsFileInsertionEvent</span><span style="color:#7F848E;font-style:italic;"> TsFileInsertionEvent to be processed</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E06C75;font-style:italic;"> eventCollector</span><span style="color:#7F848E;font-style:italic;"> used to collect result events after processing</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> Exception</span><span style="color:#7F848E;font-style:italic;"> the user can throw errors if necessary</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#C678DD;">  default</span><span style="color:#C678DD;"> void</span><span style="color:#61AFEF;"> process</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">TsFileInsertionEvent</span><span style="color:#E06C75;font-style:italic;"> tsFileInsertionEvent</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">EventCollector</span><span style="color:#E06C75;font-style:italic;"> eventCollector</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">      throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">final</span><span style="color:#E5C07B;"> TabletInsertionEvent</span><span style="color:#E06C75;"> tabletInsertionEvent</span><span style="color:#C678DD;"> :</span></span>
<span class="line"><span style="color:#E5C07B;">        tsFileInsertionEvent</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toTabletInsertionEvents</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#61AFEF;">      process</span><span style="color:#ABB2BF;">(tabletInsertionEvent, eventCollector);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * This method is called to process the Event.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E06C75;font-style:italic;"> event</span><span style="color:#7F848E;font-style:italic;"> Event to be processed</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E06C75;font-style:italic;"> eventCollector</span><span style="color:#7F848E;font-style:italic;"> used to collect result events after processing</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> Exception</span><span style="color:#7F848E;font-style:italic;"> the user can throw errors if necessary</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#C678DD;">  void</span><span style="color:#61AFEF;"> process</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Event</span><span style="color:#E06C75;font-style:italic;"> event</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">EventCollector</span><span style="color:#E06C75;font-style:italic;"> eventCollector</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="data-sending-plugin-interface" tabindex="-1"><a class="header-anchor" href="#data-sending-plugin-interface"><span>Data Sending Plugin Interface</span></a></h4><p>Data sending is the third stage of the three-stage process of stream processing, which includes data extraction, data processing, and data sending. The data sending plugin (PipeSink) is responsible for sending the various events processed by the data processing plugin (PipeProcessor). It serves as the network implementation layer of the stream processing framework and should support multiple real-time communication protocols and connectors in its interface.</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * PipeSink</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * &lt;p&gt;PipeSink is responsible for sending events to sinks.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * &lt;p&gt;Various network protocols can be supported by implementing different PipeSink classes.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * &lt;p&gt;The lifecycle of a PipeSink is as follows:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * &lt;ul&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *   &lt;li&gt;When a collaboration task is created, the KV pairs of `WITH SINK` clause in SQL are</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       parsed and the validation method {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeSink</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">validate(PipeParameterValidator)</span><span style="color:#7F848E;font-style:italic;">} will be</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       called to validate the parameters.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *   &lt;li&gt;Before the collaboration task starts, the method {@link PipeSink#customize(PipeParameters,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       PipeSinkRuntimeConfiguration)} will be called to configure the runtime behavior of the</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       PipeSink and the method {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeSink</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">handshake()</span><span style="color:#7F848E;font-style:italic;">} will be called to create a connection</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       with sink.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *   &lt;li&gt;While the collaboration task is in progress:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       &lt;ul&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *         &lt;li&gt;PipeSource captures the events and wraps them into three types of Event instances.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *         &lt;li&gt;PipeProcessor processes the event and then passes them to the PipeSink.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *         &lt;li&gt;PipeSink serializes the events into binaries and send them to sinks. The following 3</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *             methods will be called: {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeSink</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">transfer(TabletInsertionEvent)</span><span style="color:#7F848E;font-style:italic;">}, {@link</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *             PipeSink#transfer(TsFileInsertionEvent)} and {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeSink</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">transfer(Event)</span><span style="color:#7F848E;font-style:italic;">}.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       &lt;/ul&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *   &lt;li&gt;When the collaboration task is cancelled (the `DROP PIPE` command is executed), the {@link</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *       PipeSink#close() } method will be called.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * &lt;/ul&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * &lt;p&gt;In addition, the method {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeSink</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">heartbeat()</span><span style="color:#7F848E;font-style:italic;">} will be called periodically to check</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * whether the connection with sink is still alive. The method {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeSink</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">handshake()</span><span style="color:#7F848E;font-style:italic;">} will be</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * called to create a new connection with the sink when the method {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeSink</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">heartbeat()</span><span style="color:#7F848E;font-style:italic;">}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * throws exceptions.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#C678DD;"> interface</span><span style="color:#E5C07B;"> PipeSink</span><span style="color:#C678DD;"> extends</span><span style="color:#E5C07B;"> PipePlugin</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * This method is mainly used to validate {@link PipeParameters} and it is executed before {@link</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * PipeSink#customize(PipeParameters, PipeSinkRuntimeConfiguration)} is called.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E06C75;font-style:italic;"> validator</span><span style="color:#7F848E;font-style:italic;"> the validator used to validate {@link PipeParameters}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> Exception</span><span style="color:#7F848E;font-style:italic;"> if any parameter is not valid</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#C678DD;">  void</span><span style="color:#61AFEF;"> validate</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">PipeParameterValidator</span><span style="color:#E06C75;font-style:italic;"> validator</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * This method is mainly used to customize PipeSink. In this method, the user can do the following</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * things:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * &lt;ul&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *   &lt;li&gt;Use PipeParameters to parse key-value pair attributes entered by the user.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *   &lt;li&gt;Set the running configurations in PipeSinkRuntimeConfiguration.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * &lt;/ul&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * &lt;p&gt;This method is called after the method {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeSink</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">validate(PipeParameterValidator)</span><span style="color:#7F848E;font-style:italic;">} is</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * called and before the method {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeSink</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">handshake()</span><span style="color:#7F848E;font-style:italic;">} is called.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E06C75;font-style:italic;"> parameters</span><span style="color:#7F848E;font-style:italic;"> used to parse the input parameters entered by the user</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E06C75;font-style:italic;"> configuration</span><span style="color:#7F848E;font-style:italic;"> used to set the required properties of the running PipeSink</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> Exception</span><span style="color:#7F848E;font-style:italic;"> the user can throw errors if necessary</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#C678DD;">  void</span><span style="color:#61AFEF;"> customize</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">PipeParameters</span><span style="color:#E06C75;font-style:italic;"> parameters</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">PipeSinkRuntimeConfiguration</span><span style="color:#E06C75;font-style:italic;"> configuration</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">      throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * This method is used to create a connection with sink. This method will be called after the</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * method {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeSink</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">customize(PipeParameters, PipeSinkRuntimeConfiguration)</span><span style="color:#7F848E;font-style:italic;">} is called or</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * will be called when the method {</span><span style="color:#C678DD;font-style:italic;">@link</span><span style="color:#E5C07B;font-style:italic;"> PipeSink</span><span style="color:#7F848E;font-style:italic;">#</span><span style="color:#E06C75;font-style:italic;">heartbeat()</span><span style="color:#7F848E;font-style:italic;">} throws exceptions.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> Exception</span><span style="color:#7F848E;font-style:italic;"> if the connection is failed to be created</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#C678DD;">  void</span><span style="color:#61AFEF;"> handshake</span><span style="color:#ABB2BF;">()</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * This method will be called periodically to check whether the connection with sink is still</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * alive.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> Exception</span><span style="color:#7F848E;font-style:italic;"> if the connection dies</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#C678DD;">  void</span><span style="color:#61AFEF;"> heartbeat</span><span style="color:#ABB2BF;">()</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * This method is used to transfer the TabletInsertionEvent.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E06C75;font-style:italic;"> tabletInsertionEvent</span><span style="color:#7F848E;font-style:italic;"> TabletInsertionEvent to be transferred</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> PipeConnectionException</span><span style="color:#7F848E;font-style:italic;"> if the connection is broken</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> Exception</span><span style="color:#7F848E;font-style:italic;"> the user can throw errors if necessary</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#C678DD;">  void</span><span style="color:#61AFEF;"> transfer</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">TabletInsertionEvent</span><span style="color:#E06C75;font-style:italic;"> tabletInsertionEvent</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * This method is used to transfer the TsFileInsertionEvent.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E06C75;font-style:italic;"> tsFileInsertionEvent</span><span style="color:#7F848E;font-style:italic;"> TsFileInsertionEvent to be transferred</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> PipeConnectionException</span><span style="color:#7F848E;font-style:italic;"> if the connection is broken</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> Exception</span><span style="color:#7F848E;font-style:italic;"> the user can throw errors if necessary</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#C678DD;">  default</span><span style="color:#C678DD;"> void</span><span style="color:#61AFEF;"> transfer</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">TsFileInsertionEvent</span><span style="color:#E06C75;font-style:italic;"> tsFileInsertionEvent</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">    try</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">      for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">final</span><span style="color:#E5C07B;"> TabletInsertionEvent</span><span style="color:#E06C75;"> tabletInsertionEvent</span><span style="color:#C678DD;"> :</span></span>
<span class="line"><span style="color:#E5C07B;">          tsFileInsertionEvent</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toTabletInsertionEvents</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#61AFEF;">        transfer</span><span style="color:#ABB2BF;">(tabletInsertionEvent);</span></span>
<span class="line"><span style="color:#ABB2BF;">      }</span></span>
<span class="line"><span style="color:#ABB2BF;">    } </span><span style="color:#C678DD;">finally</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">      tsFileInsertionEvent</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">close</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * This method is used to transfer the generic events, including HeartbeatEvent.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E06C75;font-style:italic;"> event</span><span style="color:#7F848E;font-style:italic;"> Event to be transferred</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> PipeConnectionException</span><span style="color:#7F848E;font-style:italic;"> if the connection is broken</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * </span><span style="color:#C678DD;font-style:italic;">@throws</span><span style="color:#E5C07B;font-style:italic;"> Exception</span><span style="color:#7F848E;font-style:italic;"> the user can throw errors if necessary</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#C678DD;">  void</span><span style="color:#61AFEF;"> transfer</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Event</span><span style="color:#E06C75;font-style:italic;"> event</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="custom-stream-processing-plugin-management" tabindex="-1"><a class="header-anchor" href="#custom-stream-processing-plugin-management"><span>Custom Stream Processing Plugin Management</span></a></h2><p>To ensure the flexibility and usability of user-defined plugins in production environments, the system needs to provide the capability to dynamically manage plugins. This section introduces the management statements for stream processing plugins, which enable the dynamic and unified management of plugins.</p><h3 id="load-plugin-statement" tabindex="-1"><a class="header-anchor" href="#load-plugin-statement"><span>Load Plugin Statement</span></a></h3><p>In IoTDB, to dynamically load a user-defined plugin into the system, you first need to implement a specific plugin class based on PipeSource, PipeProcessor, or PipeSink. Then, you need to compile and package the plugin class into an executable jar file. Finally, you can use the loading plugin management statement to load the plugin into IoTDB.</p><p>The syntax of the loading plugin management statement is as follows:</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">CREATE</span><span style="color:#ABB2BF;"> PIPEPLUGIN </span><span style="color:#E06C75;">[IF NOT EXISTS]</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#ABB2BF;">alias</span><span style="color:#56B6C2;">&gt;</span></span>
<span class="line"><span style="color:#C678DD;">AS</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#ABB2BF;">Full class </span><span style="color:#C678DD;">name</span><span style="color:#56B6C2;">&gt;</span></span>
<span class="line"><span style="color:#C678DD;">USING</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#C678DD;">URL</span><span style="color:#ABB2BF;"> of jar </span><span style="color:#C678DD;">file</span><span style="color:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>IF NOT EXISTS semantics</strong>: Used in creation operations to ensure that the create command is executed when the specified Pipe Plugin does not exist, preventing errors caused by attempting to create an existing Pipe Plugin.</p><p>For example, if a user implements a data processing plugin with the fully qualified class name &quot;edu.tsinghua.iotdb.pipe.ExampleProcessor&quot; and packages it into a jar file, which is stored at &quot;<a href="https://example.com:8080/iotdb/pipe-plugin.jar" target="_blank" rel="noopener noreferrer">https://example.com:8080/iotdb/pipe-plugin.jar</a>&quot;, and the user wants to use this plugin in the stream processing engine, marking the plugin as &quot;example&quot;. The creation statement for this data processing plugin is as follows:</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">CREATE</span><span style="color:#ABB2BF;"> PIPEPLUGIN </span><span style="color:#C678DD;">IF</span><span style="color:#C678DD;"> NOT</span><span style="color:#C678DD;"> EXISTS</span><span style="color:#ABB2BF;"> example</span></span>
<span class="line"><span style="color:#C678DD;">AS</span><span style="color:#98C379;"> &#39;edu.tsinghua.iotdb.pipe.ExampleProcessor&#39;</span></span>
<span class="line"><span style="color:#C678DD;">USING</span><span style="color:#ABB2BF;"> URI </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;">https://</span><span style="color:#D19A66;">example</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">com</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">8080</span><span style="color:#ABB2BF;">/iotdb/pipe-</span><span style="color:#D19A66;">plugin</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">jar</span><span style="color:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="delete-plugin-statement" tabindex="-1"><a class="header-anchor" href="#delete-plugin-statement"><span>Delete Plugin Statement</span></a></h3><p>When user no longer wants to use a plugin and needs to uninstall the plugin from the system, you can use the Remove plugin statement as shown below.</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">DROP</span><span style="color:#ABB2BF;"> PIPEPLUGIN </span><span style="color:#E06C75;">[IF EXISTS]</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#ABB2BF;">alias</span><span style="color:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>IF EXISTS semantics</strong>: Used in deletion operations to ensure that when a specified Pipe Plugin exists, the delete command is executed to prevent errors caused by attempting to delete a non-existent Pipe Plugin.</p><h3 id="show-plugin-statement" tabindex="-1"><a class="header-anchor" href="#show-plugin-statement"><span>Show Plugin Statement</span></a></h3><p>User can also view the plugin in the system on need. The statement to view plugin is as follows.</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">SHOW PIPEPLUGINS</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="system-pre-installed-stream-processing-plugin" tabindex="-1"><a class="header-anchor" href="#system-pre-installed-stream-processing-plugin"><span>System Pre-installed Stream Processing Plugin</span></a></h2><h3 id="pre-built-source-plugin" tabindex="-1"><a class="header-anchor" href="#pre-built-source-plugin"><span>Pre-built Source Plugin</span></a></h3><h4 id="iotdb-source" tabindex="-1"><a class="header-anchor" href="#iotdb-source"><span>iotdb-source</span></a></h4><p>Function: Extract historical or realtime data inside IoTDB into pipe.</p><table><thead><tr><th>key</th><th>value</th><th>value range</th><th>required or optional with default</th></tr></thead><tbody><tr><td>source</td><td>iotdb-source</td><td>String: iotdb-source</td><td>required</td></tr><tr><td>source.pattern</td><td>path prefix for filtering time series</td><td>String: any time series prefix</td><td>optional: root</td></tr><tr><td>source.history.start-time</td><td>start of synchronizing historical data event time，including start-time</td><td>Long: [Long.MIN_VALUE, Long.MAX_VALUE]</td><td>optional: Long.MIN_VALUE</td></tr><tr><td>source.history.end-time</td><td>end of synchronizing historical data event time，including end-time</td><td>Long: [Long.MIN_VALUE, Long.MAX_VALUE]</td><td>optional: Long.MAX_VALUE</td></tr><tr><td>start-time(V1.3.1+)</td><td>start of synchronizing all data event time，including start-time. Will disable &quot;history.start-time&quot; &quot;history.end-time&quot; if configured</td><td>Long: [Long.MIN_VALUE, Long.MAX_VALUE]</td><td>optional: Long.MIN_VALUE</td></tr><tr><td>end-time(V1.3.1+)</td><td>end of synchronizing all data event time，including end-time. Will disable &quot;history.start-time&quot; &quot;history.end-time&quot; if configured</td><td>Long: [Long.MIN_VALUE, Long.MAX_VALUE]</td><td>optional: Long.MAX_VALUE</td></tr></tbody></table><blockquote><p>🚫 <strong>source.pattern Parameter Description</strong></p><ul><li><p>Pattern should use backquotes to modify illegal characters or illegal path nodes, for example, if you want to filter root.`a@b` or root.`123`, you should set the pattern to root.`a@b` or root.`123`（Refer specifically to <a href="https://iotdb.apache.org/zh/Download/#_1-0-%E7%89%88%E6%9C%AC%E4%B8%8D%E5%85%BC%E5%AE%B9%E7%9A%84%E8%AF%AD%E6%B3%95%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E" target="_blank" rel="noopener noreferrer">Timing of single and double quotes and backquotes</a>）</p></li><li><p>In the underlying implementation, when pattern is detected as root (default value) or a database name, synchronization efficiency is higher, and any other format will reduce performance.</p></li><li><p>The path prefix does not need to form a complete path. For example, when creating a pipe with the parameter &#39;source.pattern&#39;=&#39;root.aligned.1&#39;:</p><ul><li>root.aligned.1TS</li><li>root.aligned.1TS.`1`</li><li>root.aligned.100TS</li></ul><p>the data will be synchronized;</p><ul><li>root.aligned.`123`</li></ul><p>the data will not be synchronized.</p></li></ul></blockquote><blockquote><p>❗️<strong>start-time, end-time parameter description of source</strong></p><ul><li>start-time, end-time should be in ISO format, such as 2011-12-03T10:15:30 or 2011-12-03T10:15:30+01:00. However, version 1.3.1+ supports timeStamp format like 1706704494000.</li></ul></blockquote><blockquote><p>✅ <strong>A piece of data from production to IoTDB contains two key concepts of time</strong></p><ul><li><strong>event time：</strong> the time when the data is actually produced (or the generation time assigned to the data by the data production system, which is a time item in the data point), also called the event time.</li><li><strong>arrival time：</strong> the time the data arrived in the IoTDB system.</li></ul><p>The out-of-order data we often refer to refers to data whose <strong>event time</strong> is far behind the current system time (or the maximum <strong>event time</strong> that has been dropped) when the data arrives. On the other hand, whether it is out-of-order data or sequential data, as long as they arrive newly in the system, their <strong>arrival time</strong> will increase with the order in which the data arrives at IoTDB.</p></blockquote><blockquote><p>💎 <strong>the work of iotdb-source can be split into two stages</strong></p><ol><li>Historical data extraction: All data with <strong>arrival time</strong> &lt; <strong>current system time</strong> when creating the pipe is called historical data</li><li>Realtime data extraction: All data with <strong>arrival time</strong> &gt;= <strong>current system time</strong> when the pipe is created is called realtime data</li></ol><p>The historical data transmission phase and the realtime data transmission phase are executed serially. Only when the historical data transmission phase is completed, the realtime data transmission phase is executed.**</p></blockquote><h3 id="pre-built-processor-plugin" tabindex="-1"><a class="header-anchor" href="#pre-built-processor-plugin"><span>Pre-built Processor Plugin</span></a></h3><h4 id="do-nothing-processor" tabindex="-1"><a class="header-anchor" href="#do-nothing-processor"><span>do-nothing-processor</span></a></h4><p>Function: Do not do anything with the events passed in by the source.</p><table><thead><tr><th>key</th><th>value</th><th>value range</th><th>required or optional with default</th></tr></thead><tbody><tr><td>processor</td><td>do-nothing-processor</td><td>String: do-nothing-processor</td><td>required</td></tr></tbody></table><h3 id="pre-built-sink-plugin" tabindex="-1"><a class="header-anchor" href="#pre-built-sink-plugin"><span>Pre-built Sink Plugin</span></a></h3><h4 id="do-nothing-sink" tabindex="-1"><a class="header-anchor" href="#do-nothing-sink"><span>do-nothing-sink</span></a></h4><p>Function: Does not do anything with the events passed in by the processor.</p><table><thead><tr><th>key</th><th>value</th><th>value range</th><th>required or optional with default</th></tr></thead><tbody><tr><td>sink</td><td>do-nothing-sink</td><td>String: do-nothing-sink</td><td>required</td></tr></tbody></table><h2 id="stream-processing-task-management" tabindex="-1"><a class="header-anchor" href="#stream-processing-task-management"><span>Stream Processing Task Management</span></a></h2><h3 id="create-stream-processing-task" tabindex="-1"><a class="header-anchor" href="#create-stream-processing-task"><span>Create Stream Processing Task</span></a></h3><p>A stream processing task can be created using the <code>CREATE PIPE</code> statement, a sample SQL statement is shown below:</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">CREATE</span><span style="color:#ABB2BF;"> PIPE </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;">PipeId</span><span style="color:#56B6C2;">&gt;</span><span style="color:#7F848E;font-style:italic;"> -- PipeId is the name that uniquely identifies the sync task</span></span>
<span class="line"><span style="color:#C678DD;">WITH</span><span style="color:#ABB2BF;"> SOURCE (</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  -- Default IoTDB Data Extraction Plugin</span></span>
<span class="line"><span style="color:#98C379;">  &#39;source&#39;</span><span style="color:#56B6C2;">                    =</span><span style="color:#98C379;"> &#39;iotdb-source&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  -- Path prefix, only data that can match the path prefix will be extracted for subsequent processing and delivery</span></span>
<span class="line"><span style="color:#98C379;">  &#39;source.pattern&#39;</span><span style="color:#56B6C2;">            =</span><span style="color:#98C379;"> &#39;root.timecho&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  -- Whether to extract historical data</span></span>
<span class="line"><span style="color:#98C379;">  &#39;source.history.enable&#39;</span><span style="color:#56B6C2;">     =</span><span style="color:#98C379;"> &#39;true&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  -- Describes the time range of the historical data being extracted, indicating the earliest possible time</span></span>
<span class="line"><span style="color:#98C379;">  &#39;source.history.start-time&#39;</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;2011.12.03T10:15:30+01:00&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  -- Describes the time range of the extracted historical data, indicating the latest time</span></span>
<span class="line"><span style="color:#98C379;">  &#39;source.history.end-time&#39;</span><span style="color:#56B6C2;">   =</span><span style="color:#98C379;"> &#39;2022.12.03T10:15:30+01:00&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  -- Whether to extract realtime data</span></span>
<span class="line"><span style="color:#98C379;">  &#39;source.realtime.enable&#39;</span><span style="color:#56B6C2;">    =</span><span style="color:#98C379;"> &#39;true&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">WITH</span><span style="color:#ABB2BF;"> PROCESSOR (</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  -- Default data processing plugin, means no processing</span></span>
<span class="line"><span style="color:#98C379;">  &#39;processor&#39;</span><span style="color:#56B6C2;">                    =</span><span style="color:#98C379;"> &#39;do-nothing-processor&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">WITH</span><span style="color:#ABB2BF;"> SINK (</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  -- IoTDB data sending plugin with target IoTDB</span></span>
<span class="line"><span style="color:#98C379;">  &#39;sink&#39;</span><span style="color:#56B6C2;">                    =</span><span style="color:#98C379;"> &#39;iotdb-thrift-sink&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  -- Data service for one of the DataNode nodes on the target IoTDB ip</span></span>
<span class="line"><span style="color:#98C379;">  &#39;sink.ip&#39;</span><span style="color:#56B6C2;">                 =</span><span style="color:#98C379;"> &#39;127.0.0.1&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  -- Data service port of one of the DataNode nodes of the target IoTDB</span></span>
<span class="line"><span style="color:#98C379;">  &#39;sink.port&#39;</span><span style="color:#56B6C2;">               =</span><span style="color:#98C379;"> &#39;6667&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>To create a stream processing task it is necessary to configure the PipeId and the parameters of the three plugin sections:</strong></p><table><thead><tr><th>configuration item</th><th>description</th><th>Required or not</th><th>default implementation</th><th>Default implementation description</th><th>Whether to allow custom implementations</th></tr></thead><tbody><tr><td>pipeId</td><td>Globally uniquely identifies the name of a sync task</td><td><!----></td><td>-</td><td>-</td><td>-</td></tr><tr><td>source</td><td>pipe Source plugin, for extracting synchronized data at the bottom of the database</td><td>Optional</td><td>iotdb-source</td><td>Integrate all historical data of the database and subsequent realtime data into the sync task</td><td>no</td></tr><tr><td>processor</td><td>Pipe Processor plugin, for processing data</td><td>Optional</td><td>do-nothing-processor</td><td>no processing of incoming data</td><td><!----></td></tr><tr><td>sink</td><td>Pipe Sink plugin，for sending data</td><td><!----></td><td>-</td><td>-</td><td><!----></td></tr></tbody></table><p>In the example, the iotdb-source, do-nothing-processor, and iotdb-thrift-sink plugins are used to build the data synchronisation task. iotdb has other built-in data synchronisation plugins, **see the section &quot;System pre-built data synchronisation plugins&quot; <strong>. See the &quot;System Pre-installed Stream Processing Plugin&quot; section</strong>.</p><p><strong>An example of a minimalist CREATE PIPE statement is as follows:</strong></p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">CREATE</span><span style="color:#ABB2BF;"> PIPE </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;">PipeId</span><span style="color:#56B6C2;">&gt;</span><span style="color:#7F848E;font-style:italic;"> -- PipeId is a name that uniquely identifies the task.</span></span>
<span class="line"><span style="color:#C678DD;">WITH</span><span style="color:#ABB2BF;"> SINK (</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  -- IoTDB data sending plugin with target IoTDB</span></span>
<span class="line"><span style="color:#98C379;">  &#39;sink&#39;</span><span style="color:#56B6C2;">      =</span><span style="color:#98C379;"> &#39;iotdb-thrift-sink&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  -- Data service for one of the DataNode nodes on the target IoTDB ip</span></span>
<span class="line"><span style="color:#98C379;">  &#39;sink.ip&#39;</span><span style="color:#56B6C2;">   =</span><span style="color:#98C379;"> &#39;127.0.0.1&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  -- Data service port of one of the DataNode nodes of the target IoTDB</span></span>
<span class="line"><span style="color:#98C379;">  &#39;sink.port&#39;</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;6667&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The expressed semantics are: synchronise the full amount of historical data and subsequent arrivals of realtime data from this database instance to the IoTDB instance with target 127.0.0.1:6667.</p><p><strong>Note:</strong></p><ul><li><p>SOURCE and PROCESSOR are optional, if no configuration parameters are filled in, the system will use the corresponding default implementation.</p></li><li><p>The SINK is a mandatory configuration that needs to be declared in the CREATE PIPE statement for configuring purposes.</p></li><li><p>The SINK exhibits self-reusability. For different tasks, if their SINK possesses identical KV properties (where the value corresponds to every key), <strong>the system will ultimately create only one instance of the SINK</strong> to achieve resource reuse for connections.</p><ul><li>For example, there are the following pipe1, pipe2 task declarations:</li></ul><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">CREATE</span><span style="color:#ABB2BF;"> PIPE pipe1</span></span>
<span class="line"><span style="color:#C678DD;">WITH</span><span style="color:#ABB2BF;"> SINK (</span></span>
<span class="line"><span style="color:#98C379;">  &#39;sink&#39;</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;iotdb-thrift-sink&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">  &#39;sink.thrift.host&#39;</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;localhost&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">  &#39;sink.thrift.port&#39;</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;9999&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">CREATE</span><span style="color:#ABB2BF;"> PIPE pipe2</span></span>
<span class="line"><span style="color:#C678DD;">WITH</span><span style="color:#ABB2BF;"> SINK (</span></span>
<span class="line"><span style="color:#98C379;">  &#39;sink&#39;</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;iotdb-thrift-sink&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">  &#39;sink.thrift.port&#39;</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;9999&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">  &#39;sink.thrift.host&#39;</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;localhost&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Since they have identical SINK declarations (<strong>even if the order of some properties is different</strong>), the framework will automatically reuse the SINK declared by them. Hence, the SINK instances for pipe1 and pipe2 will be the same.</p></li><li><p>Please note that we should avoid constructing application scenarios that involve data cycle sync (as it can result in an infinite loop):</p></li><li><p>IoTDB A -&gt; IoTDB B -&gt; IoTDB A</p></li><li><p>IoTDB A -&gt; IoTDB A</p></li></ul><h3 id="start-stream-processing-task" tabindex="-1"><a class="header-anchor" href="#start-stream-processing-task"><span>Start Stream Processing Task</span></a></h3><p>After the successful execution of the CREATE PIPE statement, task-related instances will be created. However, the overall task&#39;s running status will be set to STOPPED(V1.3.0), meaning the task will not immediately process data. In version 1.3.1 and later, the status of the task will be set to RUNNING after CREATE.</p><p>You can use the START PIPE statement to make the stream processing task start processing data:</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">START</span><span style="color:#ABB2BF;"> PIPE </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;">PipeId</span><span style="color:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="stop-stream-processing-task" tabindex="-1"><a class="header-anchor" href="#stop-stream-processing-task"><span>Stop Stream Processing Task</span></a></h3><p>Use the STOP PIPE statement to stop the stream processing task from processing data:</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">STOP</span><span style="color:#ABB2BF;"> PIPE </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;">PipeId</span><span style="color:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="delete-stream-processing-task" tabindex="-1"><a class="header-anchor" href="#delete-stream-processing-task"><span>Delete Stream Processing Task</span></a></h3><p>If a stream processing task is in the RUNNING state, you can use the DROP PIPE statement to stop it and delete the entire task:</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">DROP</span><span style="color:#ABB2BF;"> PIPE </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;">PipeId</span><span style="color:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Before deleting a stream processing task, there is no need to execute the STOP operation.</p><h3 id="show-stream-processing-task" tabindex="-1"><a class="header-anchor" href="#show-stream-processing-task"><span>Show Stream Processing Task</span></a></h3><p>Use the SHOW PIPES statement to view all stream processing tasks:</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">SHOW PIPES</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>The query results are as follows:</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">+</span><span style="color:#7F848E;font-style:italic;">-----------+-----------------------+-------+----------+-------------+--------+----------------+</span></span>
<span class="line"><span style="color:#ABB2BF;">|         ID|          CreationTime |  </span><span style="color:#C678DD;">State</span><span style="color:#ABB2BF;">|PipeSource|PipeProcessor|PipeSink|ExceptionMessage|</span></span>
<span class="line"><span style="color:#ABB2BF;">+</span><span style="color:#7F848E;font-style:italic;">-----------+-----------------------+-------+----------+-------------+--------+----------------+</span></span>
<span class="line"><span style="color:#ABB2BF;">|iotdb-kafka|</span><span style="color:#D19A66;">2022</span><span style="color:#ABB2BF;">-</span><span style="color:#D19A66;">03</span><span style="color:#ABB2BF;">-30T20:</span><span style="color:#D19A66;">58</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">30</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">689</span><span style="color:#ABB2BF;">|RUNNING|       ...|          ...|     ...|              {}|</span></span>
<span class="line"><span style="color:#ABB2BF;">+</span><span style="color:#7F848E;font-style:italic;">-----------+-----------------------+-------+----------+-------------+--------+----------------+</span></span>
<span class="line"><span style="color:#ABB2BF;">|iotdb-iotdb|</span><span style="color:#D19A66;">2022</span><span style="color:#ABB2BF;">-</span><span style="color:#D19A66;">03</span><span style="color:#ABB2BF;">-31T12:</span><span style="color:#D19A66;">55</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">28</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">129</span><span style="color:#ABB2BF;">|</span><span style="color:#C678DD;">STOPPED</span><span style="color:#ABB2BF;">|       ...|          ...|     ...| TException: ...|</span></span>
<span class="line"><span style="color:#ABB2BF;">+</span><span style="color:#7F848E;font-style:italic;">-----------+-----------------------+-------+----------+-------------+--------+----------------+</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can use <code>&lt;PipeId&gt;</code> to specify the status of a stream processing task you want to see:</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">SHOW PIPE </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;">PipeId</span><span style="color:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Additionally, the WHERE clause can be used to determine if the Pipe Sink used by a specific &lt;PipeId&gt; is being reused.</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">SHOW PIPES</span></span>
<span class="line"><span style="color:#C678DD;">WHERE</span><span style="color:#ABB2BF;"> SINK USED </span><span style="color:#C678DD;">BY</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#ABB2BF;">PipeId</span><span style="color:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="stream-processing-task-running-status-migration" tabindex="-1"><a class="header-anchor" href="#stream-processing-task-running-status-migration"><span>Stream Processing Task Running Status Migration</span></a></h3><p>A stream processing task status can transition through several states during the lifecycle of a data synchronization pipe:</p><ul><li><strong>RUNNING：</strong> The pipe is actively processing data <ul><li>After the successful creation of a pipe, its initial state is set to RUNNING (V1.3.1+)</li></ul></li><li><strong>STOPPED：</strong> The pipe is in a stopped state. It can have the following possibilities: <ul><li>After the successful creation of a pipe, its initial state is set to RUNNING (V1.3.0)</li><li>The user manually pauses a pipe that is in normal running state, transitioning its status from RUNNING to STOPPED</li><li>If a pipe encounters an unrecoverable error during execution, its status automatically changes from RUNNING to STOPPED.</li></ul></li><li><strong>DROPPED：</strong> The pipe is permanently deleted</li></ul><p>The following diagram illustrates the different states and their transitions:</p><figure><img src="https://alioss.timecho.com/docs/img/状态迁移图.png" alt="state migration diagram" tabindex="0" loading="lazy"><figcaption>state migration diagram</figcaption></figure><h2 id="authority-management" tabindex="-1"><a class="header-anchor" href="#authority-management"><span>Authority Management</span></a></h2><h3 id="stream-processing-task" tabindex="-1"><a class="header-anchor" href="#stream-processing-task"><span>Stream Processing Task</span></a></h3><table><thead><tr><th>Authority Name</th><th>Description</th></tr></thead><tbody><tr><td>USE_PIPE</td><td>Register task,path-independent</td></tr><tr><td>USE_PIPE</td><td>Start task,path-independent</td></tr><tr><td>USE_PIPE</td><td>Stop task,path-independent</td></tr><tr><td>USE_PIPE</td><td>Uninstall task,path-independent</td></tr><tr><td>USE_PIPE</td><td>Query task,path-independent</td></tr></tbody></table><h3 id="stream-processing-task-plugin" tabindex="-1"><a class="header-anchor" href="#stream-processing-task-plugin"><span>Stream Processing Task Plugin</span></a></h3><table><thead><tr><th>Authority Name</th><th>Description</th></tr></thead><tbody><tr><td>USE_PIPE</td><td>Register stream processing task plugin,path-independent</td></tr><tr><td>USE_PIPE</td><td>Delete stream processing task plugin,path-independent</td></tr><tr><td>USE_PIPE</td><td>Query stream processing task plugin,path-independent</td></tr></tbody></table><h2 id="configure-parameters" tabindex="-1"><a class="header-anchor" href="#configure-parameters"><span>Configure Parameters</span></a></h2><p>In iotdb-system.properties ：</p><p>V1.3.0:</p><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" data-title="properties" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">####################</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">### Pipe Configuration</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">####################</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># Uncomment the following field to configure the pipe lib directory.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># For Windows platform</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># If its prefix is a drive specifier followed by &quot;\\&quot;, or if its prefix is &quot;\\\\&quot;, then the path is</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># absolute. Otherwise, it is relative.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># pipe_lib_dir=ext\\pipe</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># For Linux platform</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># If its prefix is &quot;/&quot;, then the path is absolute. Otherwise, it is relative.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># pipe_lib_dir=ext/pipe</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># The maximum number of threads that can be used to execute the pipe subtasks in PipeSubtaskExecutor.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># The actual value will be min(pipe_subtask_executor_max_thread_num, max(1, CPU core number / 2)).</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># pipe_subtask_executor_max_thread_num=5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># The connection timeout (in milliseconds) for the thrift client.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># pipe_connector_timeout_ms=900000</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># The maximum number of selectors that can be used in the async connector.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># pipe_async_connector_selector_number=1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># The core number of clients that can be used in the async connector.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># pipe_async_connector_core_client_number=8</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># The maximum number of clients that can be used in the async connector.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># pipe_async_connector_max_client_number=16</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>V1.3.1+:</p><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" data-title="properties" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">####################</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">### Pipe Configuration</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">####################</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># Uncomment the following field to configure the pipe lib directory.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># For Windows platform</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># If its prefix is a drive specifier followed by &quot;\\&quot;, or if its prefix is &quot;\\\\&quot;, then the path is</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># absolute. Otherwise, it is relative.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># pipe_lib_dir=ext\\pipe</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># For Linux platform</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># If its prefix is &quot;/&quot;, then the path is absolute. Otherwise, it is relative.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># pipe_lib_dir=ext/pipe</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># The maximum number of threads that can be used to execute the pipe subtasks in PipeSubtaskExecutor.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># The actual value will be min(pipe_subtask_executor_max_thread_num, max(1, CPU core number / 2)).</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># pipe_subtask_executor_max_thread_num=5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># The connection timeout (in milliseconds) for the thrift client.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># pipe_sink_timeout_ms=900000</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># The maximum number of selectors that can be used in the sink.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># Recommend to set this value to less than or equal to pipe_sink_max_client_number.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># pipe_sink_selector_number=4</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># The maximum number of clients that can be used in the sink.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># pipe_sink_max_client_number=16</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/apache/iotdb-docs/edit/main/src/UserGuide/V2.0.1/Tree/User-Manual/Streaming_apache.md" aria-label="Found Error? Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Found Error? Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">Last update: </span><span class="vp-meta-info" data-allow-mismatch="text">12/16/2024, 9:26:25 AM</span></div><!----></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="site-footer"><span id="doc-version" style="display:none;">V2.0.1</span><p class="copyright-text">Copyright © 2025 The Apache Software Foundation.
Apache IoTDB, IoTDB, Apache, the Apache feather logo, and the Apache IoTDB project logo are either registered trademarks or trademarks of The Apache Software Foundation in all countries</p><p style="text-align:center;margin-top:10px;color:#909399;font-size:12px;margin:0 30px;"><strong>Having questions?</strong> Connect with us on QQ, WeChat, or Slack. <a href="https://github.com/apache/iotdb/issues/1995">Join the community</a></p></footer></div><!--]--><!--]--><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-D0_NMnAJ.js" defer></script>
  </body>
</html>
