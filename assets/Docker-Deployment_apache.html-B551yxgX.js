import{_ as n,c as a,b as e,o as l}from"./app-BrzuM4xY.js";const o={};function p(i,s){return l(),a("div",null,s[0]||(s[0]=[e(`<h1 id="docker部署" tabindex="-1"><a class="header-anchor" href="#docker部署"><span>Docker部署</span></a></h1><h2 id="环境准备" tabindex="-1"><a class="header-anchor" href="#环境准备"><span>环境准备</span></a></h2><h3 id="docker安装" tabindex="-1"><a class="header-anchor" href="#docker安装"><span>Docker安装</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">#以ubuntu为例，其他操作系统可以自行搜索安装方法</span></span>
<span class="line"><span style="color:#ABB2BF;">#step1: 安装一些必要的系统工具</span></span>
<span class="line"><span style="color:#ABB2BF;">sudo apt-</span><span style="color:#C678DD;">get</span><span style="color:#C678DD;"> update</span></span>
<span class="line"><span style="color:#ABB2BF;">sudo apt-</span><span style="color:#C678DD;">get</span><span style="color:#ABB2BF;"> -y install apt-transport-https ca-certificates curl software-properties-common</span></span>
<span class="line"><span style="color:#ABB2BF;">#step2: 安装GPG证书</span></span>
<span class="line"><span style="color:#ABB2BF;">curl -fsSL https://</span><span style="color:#D19A66;">mirrors</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">aliyun</span><span style="color:#ABB2BF;">.com/docker-ce/linux/ubuntu/gpg | sudo apt-</span><span style="color:#C678DD;">key</span><span style="color:#C678DD;"> add</span><span style="color:#ABB2BF;"> -</span></span>
<span class="line"><span style="color:#ABB2BF;">#step3: 写入软件源信息</span></span>
<span class="line"><span style="color:#ABB2BF;">sudo </span><span style="color:#C678DD;">add</span><span style="color:#ABB2BF;">-apt-repository </span><span style="color:#98C379;">&quot;deb [arch=amd64] https://mirrors.aliyun.com/docker-ce/linux/ubuntu $(lsb_release -cs) stable&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">#step4: 更新并安装Docker-CE</span></span>
<span class="line"><span style="color:#ABB2BF;">sudo apt-</span><span style="color:#C678DD;">get</span><span style="color:#ABB2BF;"> -y </span><span style="color:#C678DD;">update</span></span>
<span class="line"><span style="color:#ABB2BF;">sudo apt-</span><span style="color:#C678DD;">get</span><span style="color:#ABB2BF;"> -y install docker-ce</span></span>
<span class="line"><span style="color:#ABB2BF;">#step5: 设置docker开机自启动</span></span>
<span class="line"><span style="color:#ABB2BF;">sudo systemctl </span><span style="color:#C678DD;">enable</span><span style="color:#ABB2BF;"> docker</span></span>
<span class="line"><span style="color:#ABB2BF;">#step6： 验证docker是否安装成功</span></span>
<span class="line"><span style="color:#ABB2BF;">docker </span><span style="color:#7F848E;font-style:italic;">--version  #显示版本信息，即安装成功</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="docker-compose安装" tabindex="-1"><a class="header-anchor" href="#docker-compose安装"><span>docker-compose安装</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">#安装命令</span></span>
<span class="line"><span style="color:#ABB2BF;">curl -L </span><span style="color:#98C379;">&quot;https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname -s)-$(uname -m)&quot;</span><span style="color:#ABB2BF;"> -o /usr/</span><span style="color:#C678DD;">local</span><span style="color:#ABB2BF;">/bin/docker-compose</span></span>
<span class="line"><span style="color:#ABB2BF;">chmod +x /usr/</span><span style="color:#C678DD;">local</span><span style="color:#ABB2BF;">/bin/docker-compose</span></span>
<span class="line"><span style="color:#ABB2BF;">ln -s  /usr/</span><span style="color:#C678DD;">local</span><span style="color:#ABB2BF;">/bin/docker-compose  /usr/bin/docker-compose</span></span>
<span class="line"><span style="color:#ABB2BF;">#验证是否安装成功</span></span>
<span class="line"><span style="color:#ABB2BF;">docker-compose </span><span style="color:#7F848E;font-style:italic;">--version  #显示版本信息即安装成功</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="单机版" tabindex="-1"><a class="header-anchor" href="#单机版"><span>单机版</span></a></h2><p>本节演示如何部署1C1D的docker单机版。</p><h3 id="拉取镜像文件" tabindex="-1"><a class="header-anchor" href="#拉取镜像文件"><span>拉取镜像文件</span></a></h3><p>Apache IoTDB的Docker镜像已经上传至<a href="https://hub.docker.com/r/apache/iotdb%E3%80%82" target="_blank" rel="noopener noreferrer">https://hub.docker.com/r/apache/iotdb。</a></p><p>以获取1.3.2版本为例，拉取镜像命令：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#61AFEF;">docker</span><span style="color:#98C379;"> pull</span><span style="color:#98C379;"> apache/iotdb:1.3.2-standalone</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>查看镜像：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#61AFEF;">docker</span><span style="color:#98C379;"> images</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://alioss.timecho.com/docs/img/开源-拉取镜像.PNG" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="创建docker-bridge网络" tabindex="-1"><a class="header-anchor" href="#创建docker-bridge网络"><span>创建docker bridge网络</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#61AFEF;">docker</span><span style="color:#98C379;"> network</span><span style="color:#98C379;"> create</span><span style="color:#D19A66;"> --driver=bridge</span><span style="color:#D19A66;"> --subnet=172.18.0.0/16</span><span style="color:#D19A66;"> --gateway=172.18.0.1</span><span style="color:#98C379;">  iotdb</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="编写docker-compose的yml文件" tabindex="-1"><a class="header-anchor" href="#编写docker-compose的yml文件"><span>编写docker-compose的yml文件</span></a></h3><p>这里我们以把IoTDB安装目录和yml文件统一放在<code>/docker-iotdb</code>文件夹下为例：</p><p>文件目录结构为：<code>/docker-iotdb/iotdb</code>, <code>/docker-iotdb/docker-compose-standalone.yml </code></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#61AFEF;">docker-iotdb：</span></span>
<span class="line"><span style="color:#61AFEF;">├──</span><span style="color:#98C379;"> iotdb</span><span style="color:#7F848E;font-style:italic;">  #iotdb安装目录</span></span>
<span class="line"><span style="color:#61AFEF;">│──</span><span style="color:#98C379;"> docker-compose-standalone.yml</span><span style="color:#7F848E;font-style:italic;"> #单机版docker-compose的yml文件</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>完整的docker-compose-standalone.yml 内容如下：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#61AFEF;">version:</span><span style="color:#98C379;"> &quot;3&quot;</span></span>
<span class="line"><span style="color:#61AFEF;">services:</span></span>
<span class="line"><span style="color:#61AFEF;">  iotdb-service:</span></span>
<span class="line"><span style="color:#61AFEF;">    image:</span><span style="color:#98C379;"> apache/iotdb:1.3.2-standalone</span><span style="color:#7F848E;font-style:italic;"> #使用的镜像</span></span>
<span class="line"><span style="color:#61AFEF;">    hostname:</span><span style="color:#98C379;"> iotdb</span></span>
<span class="line"><span style="color:#61AFEF;">    container_name:</span><span style="color:#98C379;"> iotdb</span></span>
<span class="line"><span style="color:#61AFEF;">    restart:</span><span style="color:#98C379;"> always</span><span style="color:#ABB2BF;">       </span></span>
<span class="line"><span style="color:#61AFEF;">    ports:</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> &quot;6667:6667&quot;</span></span>
<span class="line"><span style="color:#61AFEF;">    environment:</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> cn_internal_address=iotdb</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> cn_internal_port=</span><span style="color:#D19A66;">10710</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> cn_consensus_port=</span><span style="color:#D19A66;">10720</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> cn_seed_config_node=iotdb:10710</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> dn_rpc_address=iotdb</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> dn_internal_address=iotdb</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> dn_rpc_port=</span><span style="color:#D19A66;">6667</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> dn_internal_port=</span><span style="color:#D19A66;">10730</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> dn_mpp_data_exchange_port=</span><span style="color:#D19A66;">10740</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> dn_schema_region_consensus_port=</span><span style="color:#D19A66;">10750</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> dn_data_region_consensus_port=</span><span style="color:#D19A66;">10760</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> dn_seed_config_node=iotdb:10710</span></span>
<span class="line"><span style="color:#61AFEF;">    privileged:</span><span style="color:#D19A66;"> true</span></span>
<span class="line"><span style="color:#61AFEF;">    volumes:</span></span>
<span class="line"><span style="color:#61AFEF;">        -</span><span style="color:#98C379;"> ./iotdb/data:/iotdb/data</span></span>
<span class="line"><span style="color:#61AFEF;">        -</span><span style="color:#98C379;"> ./iotdb/logs:/iotdb/logs</span></span>
<span class="line"><span style="color:#61AFEF;">    networks:</span></span>
<span class="line"><span style="color:#61AFEF;">      iotdb:</span></span>
<span class="line"><span style="color:#61AFEF;">        ipv4_address:</span><span style="color:#D19A66;"> 172.18.0.6</span></span>
<span class="line"><span style="color:#61AFEF;">networks:</span></span>
<span class="line"><span style="color:#61AFEF;">  iotdb:</span></span>
<span class="line"><span style="color:#61AFEF;">    external:</span><span style="color:#D19A66;"> true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="启动iotdb" tabindex="-1"><a class="header-anchor" href="#启动iotdb"><span>启动IoTDB</span></a></h3><p>使用下面的命令启动：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#56B6C2;">cd</span><span style="color:#98C379;">　/docker-iotdb</span></span>
<span class="line"><span style="color:#61AFEF;">docker-compose</span><span style="color:#D19A66;"> -f</span><span style="color:#98C379;"> docker-compose-standalone.yml</span><span style="color:#98C379;"> up</span><span style="color:#D19A66;">  -d</span><span style="color:#7F848E;font-style:italic;">  #后台启动</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="验证部署" tabindex="-1"><a class="header-anchor" href="#验证部署"><span>验证部署</span></a></h3><ul><li><p>查看日志，有如下字样，表示启动成功</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">docker logs -f iotdb-datanode #查看日志命令</span></span>
<span class="line"><span style="color:#D19A66;">2024</span><span style="color:#ABB2BF;">-</span><span style="color:#D19A66;">07</span><span style="color:#ABB2BF;">-</span><span style="color:#D19A66;">21</span><span style="color:#D19A66;"> 08</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">22</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">38</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">457</span><span style="color:#E06C75;"> [main]</span><span style="color:#ABB2BF;"> INFO  </span><span style="color:#D19A66;">o</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">a</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">i</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">db</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">service</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">DataNode</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">227</span><span style="color:#ABB2BF;"> - Congratulations, IoTDB DataNode </span><span style="color:#C678DD;">is</span><span style="color:#C678DD;"> set</span><span style="color:#ABB2BF;"> up successfully. </span><span style="color:#C678DD;">Now</span><span style="color:#ABB2BF;">, enjoy yourself!</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://alioss.timecho.com/docs/img/开源-验证部署.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>进入容器，查看服务运行状态</p><p>查看启动的容器</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">docker ps</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://alioss.timecho.com/docs/img/开源-验证部署2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>进入容器, 通过cli登录数据库, 使用show cluster命令查看服务状态</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">docker </span><span style="color:#C678DD;">exec</span><span style="color:#ABB2BF;"> -it iotdb  /bin/bash         #进入容器</span></span>
<span class="line"><span style="color:#ABB2BF;">./</span><span style="color:#C678DD;">start</span><span style="color:#ABB2BF;">-</span><span style="color:#D19A66;">cli</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">sh</span><span style="color:#ABB2BF;"> -h iotdb                  #登录数据库</span></span>
<span class="line"><span style="color:#ABB2BF;">IoTDB</span><span style="color:#56B6C2;">&gt;</span><span style="color:#ABB2BF;"> show cluster                      #查看服务状态</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到服务状态都是running, 说明IoTDB部署成功。</p><figure><img src="https://alioss.timecho.com/docs/img/开源-验证部署3.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ul><h3 id="映射-conf目录-可选" tabindex="-1"><a class="header-anchor" href="#映射-conf目录-可选"><span>映射/conf目录(可选)</span></a></h3><p>后续如果想在物理机中直接修改配置文件，可以把容器中的/conf文件夹映射出来，分三步：</p><p>步骤一：拷贝容器中的/conf目录到<code>/docker-iotdb/iotdb/conf</code></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#61AFEF;">docker</span><span style="color:#98C379;"> cp</span><span style="color:#98C379;"> iotdb:/iotdb/conf</span><span style="color:#98C379;"> /docker-iotdb/iotdb/conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>步骤二：在<code>docker-compose-standalone.yml</code>中添加映射</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#61AFEF;">    volumes:</span></span>
<span class="line"><span style="color:#61AFEF;">        -</span><span style="color:#98C379;"> ./iotdb/conf:/iotdb/conf</span><span style="color:#7F848E;font-style:italic;">   #增加这个/conf文件夹的映射</span></span>
<span class="line"><span style="color:#61AFEF;">        -</span><span style="color:#98C379;"> ./iotdb/data:/iotdb/data</span></span>
<span class="line"><span style="color:#61AFEF;">        -</span><span style="color:#98C379;"> ./iotdb/logs:/iotdb/logs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>步骤三：重新启动IoTDB</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#61AFEF;">docker-compose</span><span style="color:#D19A66;">  -f</span><span style="color:#98C379;"> docker-compose-standalone.yml</span><span style="color:#98C379;">  up</span><span style="color:#D19A66;">  -d</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="集群版" tabindex="-1"><a class="header-anchor" href="#集群版"><span>集群版</span></a></h2><p>本小节描述如何手动部署包括3个ConfigNode和3个DataNode的实例，即通常所说的3C3D集群。</p><div align="center"><img src="https://alioss.timecho.com/docs/img/集群部署.png" alt="" style="width:60%;"></div><p><strong>注意：集群版目前只支持host网络和overlay 网络，不支持bridge网络。</strong></p><p>下面以host网络为例演示如何部署3C3D集群。</p><h3 id="设置主机名" tabindex="-1"><a class="header-anchor" href="#设置主机名"><span>设置主机名</span></a></h3><p>假设现在有3台linux服务器，IP地址和服务角色分配如下：</p><table><thead><tr><th>节点ip</th><th>主机名</th><th>服务</th></tr></thead><tbody><tr><td>192.168.1.3</td><td>iotdb-1</td><td>ConfigNode、DataNode</td></tr><tr><td>192.168.1.4</td><td>iotdb-2</td><td>ConfigNode、DataNode</td></tr><tr><td>192.168.1.5</td><td>iotdb-3</td><td>ConfigNode、DataNode</td></tr></tbody></table><p>在3台机器上分别配置主机名，设置主机名需要在目标服务器上配置<code>/etc/hosts</code>，使用如下命令：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#56B6C2;">echo</span><span style="color:#98C379;"> &quot;192.168.1.3  iotdb-1&quot;</span><span style="color:#ABB2BF;">  &gt;&gt; </span><span style="color:#98C379;">/etc/hosts</span></span>
<span class="line"><span style="color:#56B6C2;">echo</span><span style="color:#98C379;"> &quot;192.168.1.4  iotdb-2&quot;</span><span style="color:#ABB2BF;">  &gt;&gt; </span><span style="color:#98C379;">/etc/hosts</span></span>
<span class="line"><span style="color:#56B6C2;">echo</span><span style="color:#98C379;"> &quot;192.168.1.5  iotdb-3&quot;</span><span style="color:#ABB2BF;">  &gt;&gt; </span><span style="color:#98C379;">/etc/hosts</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="拉取镜像文件-1" tabindex="-1"><a class="header-anchor" href="#拉取镜像文件-1"><span>拉取镜像文件</span></a></h3><p>Apache IoTDB的Docker镜像已经上传至<a href="https://hub.docker.com/r/apache/iotdb%E3%80%82" target="_blank" rel="noopener noreferrer">https://hub.docker.com/r/apache/iotdb。</a></p><p>在3台服务器上分别拉取IoTDB镜像，以获取1.3.2版本为例，拉取镜像命令：</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">docker pull apache/iotdb:</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">-standalone</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>查看镜像：</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">docker images</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://alioss.timecho.com/docs/img/开源-集群版1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="编写docker-compose的yml文件-1" tabindex="-1"><a class="header-anchor" href="#编写docker-compose的yml文件-1"><span>编写docker-compose的yml文件</span></a></h3><p>这里我们以把IoTDB安装目录和yml文件统一放在<code>/docker-iotdb</code>文件夹下为例：</p><p>文件目录结构为：<code>/docker-iotdb/iotdb</code>， <code>/docker-iotdb/confignode.yml</code>，<code>/docker-iotdb/datanode.yml</code></p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">docker-iotdb：</span></span>
<span class="line"><span style="color:#ABB2BF;">├── </span><span style="color:#D19A66;">confignode</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">yml</span><span style="color:#ABB2BF;"> #confignode的yml文件</span></span>
<span class="line"><span style="color:#ABB2BF;">├── </span><span style="color:#D19A66;">datanode</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">yml</span><span style="color:#ABB2BF;">   #datanode的yml文件</span></span>
<span class="line"><span style="color:#ABB2BF;">└── iotdb          #IoTDB安装目录</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在每台服务器上都要编写2个yml文件，即confignode.yml和datanode.yml，yml示例如下：</p><p><strong>confignode.yml：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">#confignode.yml</span></span>
<span class="line"><span style="color:#61AFEF;">version:</span><span style="color:#98C379;"> &quot;3&quot;</span></span>
<span class="line"><span style="color:#61AFEF;">services:</span></span>
<span class="line"><span style="color:#61AFEF;">  iotdb-confignode:</span></span>
<span class="line"><span style="color:#61AFEF;">    image:</span><span style="color:#98C379;"> apache/iotdb:1.3.2-standalone</span><span style="color:#7F848E;font-style:italic;"> #使用的镜像</span></span>
<span class="line"><span style="color:#61AFEF;">    hostname:</span><span style="color:#98C379;"> iotdb-1</span><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">iotdb-2</span><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">iotdb-3</span><span style="color:#7F848E;font-style:italic;">    #根据实际情况选择，三选一</span></span>
<span class="line"><span style="color:#61AFEF;">    container_name:</span><span style="color:#98C379;"> iotdb-confignode</span></span>
<span class="line"><span style="color:#56B6C2;">    command</span><span style="color:#98C379;">:</span><span style="color:#ABB2BF;"> [</span><span style="color:#98C379;">&quot;bash&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;-c&quot;,</span><span style="color:#98C379;"> &quot;entrypoint.sh confignode&quot;]</span></span>
<span class="line"><span style="color:#61AFEF;">    restart:</span><span style="color:#98C379;"> always</span></span>
<span class="line"><span style="color:#61AFEF;">    environment:</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> cn_internal_address=iotdb-1</span><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">iotdb-2</span><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">iotdb-3</span><span style="color:#7F848E;font-style:italic;"> #根据实际情况选择，三选一</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> cn_internal_port=</span><span style="color:#D19A66;">10710</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> cn_consensus_port=</span><span style="color:#D19A66;">10720</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> cn_seed_config_node=iotdb-1:10710</span><span style="color:#7F848E;font-style:italic;">   #默认第一台为seed节点</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> schema_replication_factor=</span><span style="color:#D19A66;">3</span><span style="color:#7F848E;font-style:italic;">         #元数据副本数</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> data_replication_factor=</span><span style="color:#D19A66;">2</span><span style="color:#7F848E;font-style:italic;">           #数据副本数</span></span>
<span class="line"><span style="color:#61AFEF;">    privileged:</span><span style="color:#D19A66;"> true</span></span>
<span class="line"><span style="color:#61AFEF;">    volumes:</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> ./iotdb/data:/iotdb/data</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> ./iotdb/logs:/iotdb/logs</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> /dev/mem:/dev/mem:ro</span></span>
<span class="line"><span style="color:#61AFEF;">    network_mode:</span><span style="color:#98C379;"> &quot;host&quot;</span><span style="color:#7F848E;font-style:italic;">    #使用host网络</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>datanode.yml：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">#datanode.yml</span></span>
<span class="line"><span style="color:#61AFEF;">version:</span><span style="color:#98C379;"> &quot;3&quot;</span></span>
<span class="line"><span style="color:#61AFEF;">services:</span></span>
<span class="line"><span style="color:#61AFEF;">  iotdb-datanode:</span></span>
<span class="line"><span style="color:#61AFEF;">    image:</span><span style="color:#98C379;"> iotdb-enterprise:1.3.2.3-standalone</span><span style="color:#7F848E;font-style:italic;"> #使用的镜像</span></span>
<span class="line"><span style="color:#61AFEF;">    hostname:</span><span style="color:#98C379;"> iotdb-1</span><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">iotdb-2</span><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">iotdb-3</span><span style="color:#7F848E;font-style:italic;"> #根据实际情况选择，三选一</span></span>
<span class="line"><span style="color:#61AFEF;">    container_name:</span><span style="color:#98C379;"> iotdb-datanode</span></span>
<span class="line"><span style="color:#56B6C2;">    command</span><span style="color:#98C379;">:</span><span style="color:#ABB2BF;"> [</span><span style="color:#98C379;">&quot;bash&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;-c&quot;,</span><span style="color:#98C379;"> &quot;entrypoint.sh datanode&quot;]</span></span>
<span class="line"><span style="color:#61AFEF;">    restart:</span><span style="color:#98C379;"> always</span></span>
<span class="line"><span style="color:#61AFEF;">    ports:</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> &quot;6667:6667&quot;</span></span>
<span class="line"><span style="color:#61AFEF;">    privileged:</span><span style="color:#D19A66;"> true</span></span>
<span class="line"><span style="color:#61AFEF;">    environment:</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> dn_rpc_address=iotdb-1</span><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">iotdb-2</span><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">iotdb-3</span><span style="color:#7F848E;font-style:italic;">  #根据实际情况选择，三选一</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> dn_internal_address=iotdb-1</span><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">iotdb-2</span><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">iotdb-3</span><span style="color:#7F848E;font-style:italic;"> #根据实际情况选择，三选一</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> dn_seed_config_node=iotdb-1:10710</span><span style="color:#7F848E;font-style:italic;">      #默认第1台为seed节点</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> dn_rpc_port=</span><span style="color:#D19A66;">6667</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> dn_internal_port=</span><span style="color:#D19A66;">10730</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> dn_mpp_data_exchange_port=</span><span style="color:#D19A66;">10740</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> dn_schema_region_consensus_port=</span><span style="color:#D19A66;">10750</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> dn_data_region_consensus_port=</span><span style="color:#D19A66;">10760</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> schema_replication_factor=</span><span style="color:#D19A66;">3</span><span style="color:#7F848E;font-style:italic;">         #元数据副本数</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> data_replication_factor=</span><span style="color:#D19A66;">2</span><span style="color:#7F848E;font-style:italic;">           #数据副本数</span></span>
<span class="line"><span style="color:#61AFEF;">    volumes:</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> ./iotdb/data:/iotdb/data</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> ./iotdb/logs:/iotdb/logs</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> /dev/mem:/dev/mem:ro</span></span>
<span class="line"><span style="color:#61AFEF;">    network_mode:</span><span style="color:#98C379;"> &quot;host&quot;</span><span style="color:#7F848E;font-style:italic;">      #使用host网络</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="首次启动confignode" tabindex="-1"><a class="header-anchor" href="#首次启动confignode"><span>首次启动confignode</span></a></h3><p>先在3台服务器上分别启动confignode, 注意启动顺序，先启动第1台iotdb-1,再启动iotdb-2和iotdb-3。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#56B6C2;">cd</span><span style="color:#98C379;">　/docker-iotdb</span></span>
<span class="line"><span style="color:#61AFEF;">docker-compose</span><span style="color:#D19A66;"> -f</span><span style="color:#98C379;"> confignode.yml</span><span style="color:#98C379;"> up</span><span style="color:#D19A66;">  -d</span><span style="color:#7F848E;font-style:italic;"> #后台启动</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="启动datanode" tabindex="-1"><a class="header-anchor" href="#启动datanode"><span>启动datanode</span></a></h3><p>在3台服务器上分别启动datanode</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">cd /docker-iotdb</span></span>
<span class="line"><span style="color:#ABB2BF;">docker-compose  -f  </span><span style="color:#D19A66;">datanode</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">yml</span><span style="color:#ABB2BF;">  up -d #后台启动</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://alioss.timecho.com/docs/img/开源-集群版2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="验证部署-1" tabindex="-1"><a class="header-anchor" href="#验证部署-1"><span>验证部署</span></a></h3><ul><li><p>查看日志,有如下字样，表示datanode启动成功</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">docker logs -f iotdb-datanode #查看日志命令</span></span>
<span class="line"><span style="color:#D19A66;">2024</span><span style="color:#ABB2BF;">-</span><span style="color:#D19A66;">07</span><span style="color:#ABB2BF;">-</span><span style="color:#D19A66;">21</span><span style="color:#D19A66;"> 09</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">40</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">58</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">120</span><span style="color:#E06C75;"> [main]</span><span style="color:#ABB2BF;"> INFO  </span><span style="color:#D19A66;">o</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">a</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">i</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">db</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">service</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">DataNode</span><span style="color:#ABB2BF;">:</span><span style="color:#D19A66;">227</span><span style="color:#ABB2BF;"> - Congratulations, IoTDB DataNode </span><span style="color:#C678DD;">is</span><span style="color:#C678DD;"> set</span><span style="color:#ABB2BF;"> up successfully. </span><span style="color:#C678DD;">Now</span><span style="color:#ABB2BF;">, enjoy yourself!</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://alioss.timecho.com/docs/img/开源-集群版3.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>进入容器，查看服务运行状态</p><p>查看启动的容器</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">docker ps</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://alioss.timecho.com/docs/img/开源-集群版4.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>进入任意一个容器, 通过cli登录数据库, 使用show cluster命令查看服务状态</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">docker </span><span style="color:#C678DD;">exec</span><span style="color:#ABB2BF;"> -it iotdb-datanode /bin/bash     #进入容器</span></span>
<span class="line"><span style="color:#ABB2BF;">./</span><span style="color:#C678DD;">start</span><span style="color:#ABB2BF;">-</span><span style="color:#D19A66;">cli</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">sh</span><span style="color:#ABB2BF;"> -h iotdb-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">                    #登录数据库</span></span>
<span class="line"><span style="color:#ABB2BF;">IoTDB</span><span style="color:#56B6C2;">&gt;</span><span style="color:#ABB2BF;"> show cluster                          #查看服务状态</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到服务状态都是running, 说明IoTDB部署成功。</p><figure><img src="https://alioss.timecho.com/docs/img/开源-集群版5.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ul><h3 id="映射-conf目录-可选-1" tabindex="-1"><a class="header-anchor" href="#映射-conf目录-可选-1"><span>映射/conf目录(可选)</span></a></h3><p>后续如果想在物理机中直接修改配置文件，可以把容器中的/conf文件夹映射出来，分三步：</p><p>步骤一：在3台服务器中分别拷贝容器中的/conf目录到/docker-iotdb/iotdb/conf</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#61AFEF;">docker</span><span style="color:#98C379;"> cp</span><span style="color:#98C379;"> iotdb-confignode:/iotdb/conf</span><span style="color:#98C379;"> /docker-iotdb/iotdb/conf</span></span>
<span class="line"><span style="color:#61AFEF;">或者</span></span>
<span class="line"><span style="color:#61AFEF;">docker</span><span style="color:#98C379;"> cp</span><span style="color:#98C379;"> iotdb-datanode:/iotdb/conf</span><span style="color:#98C379;">   /docker-iotdb/iotdb/conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>步骤二：在3台服务器的confignode.yml和datanode.yml中添加/conf目录映射</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">#confignode.yml</span></span>
<span class="line"><span style="color:#61AFEF;">    volumes:</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> ./iotdb/conf:/iotdb/conf</span><span style="color:#7F848E;font-style:italic;">  #增加这个/conf文件夹的映射</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> ./iotdb/data:/iotdb/data</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> ./iotdb/logs:/iotdb/logs</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> /dev/mem:/dev/mem:ro</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#datanode.yml</span></span>
<span class="line"><span style="color:#61AFEF;">    volumes:</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> ./iotdb/conf:/iotdb/conf</span><span style="color:#7F848E;font-style:italic;">   #增加这个/conf文件夹的映射</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> ./iotdb/data:/iotdb/data</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> ./iotdb/logs:/iotdb/logs</span></span>
<span class="line"><span style="color:#61AFEF;">      -</span><span style="color:#98C379;"> /dev/mem:/dev/mem:ro</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>步骤三：在3台服务器上重新启动IoTDB</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#56B6C2;">cd</span><span style="color:#98C379;"> /docker-iotdb</span></span>
<span class="line"><span style="color:#61AFEF;">docker-compose</span><span style="color:#D19A66;">  -f</span><span style="color:#98C379;"> confignode.yml</span><span style="color:#98C379;">  up</span><span style="color:#D19A66;">  -d</span></span>
<span class="line"><span style="color:#61AFEF;">docker-compose</span><span style="color:#D19A66;">  -f</span><span style="color:#98C379;"> datanode.yml</span><span style="color:#98C379;">    up</span><span style="color:#D19A66;">  -d</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,79)]))}const t=n(o,[["render",p],["__file","Docker-Deployment_apache.html.vue"]]),r=JSON.parse('{"path":"/zh/UserGuide/V2.0.1/Tree/Deployment-and-Maintenance/Docker-Deployment_apache.html","title":"Docker部署","lang":"zh-CN","frontmatter":{"description":"Docker部署 环境准备 Docker安装 docker-compose安装 单机版 本节演示如何部署1C1D的docker单机版。 拉取镜像文件 Apache IoTDB的Docker镜像已经上传至https://hub.docker.com/r/apache/iotdb。 以获取1.3.2版本为例，拉取镜像命令： 查看镜像： 创建docker b...","head":[["link",{"rel":"alternate","hreflang":"en-us","href":"https://iotdb.apache.org/UserGuide/V2.0.1/Tree/Deployment-and-Maintenance/Docker-Deployment_apache.html"}],["meta",{"property":"og:url","content":"https://iotdb.apache.org/zh/UserGuide/V2.0.1/Tree/Deployment-and-Maintenance/Docker-Deployment_apache.html"}],["meta",{"property":"og:site_name","content":"IoTDB Website"}],["meta",{"property":"og:title","content":"Docker部署"}],["meta",{"property":"og:description","content":"Docker部署 环境准备 Docker安装 docker-compose安装 单机版 本节演示如何部署1C1D的docker单机版。 拉取镜像文件 Apache IoTDB的Docker镜像已经上传至https://hub.docker.com/r/apache/iotdb。 以获取1.3.2版本为例，拉取镜像命令： 查看镜像： 创建docker b..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://alioss.timecho.com/docs/img/%E5%BC%80%E6%BA%90-%E6%8B%89%E5%8F%96%E9%95%9C%E5%83%8F.PNG"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:locale:alternate","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-12-25T11:56:27.000Z"}],["meta",{"property":"article:modified_time","content":"2024-12-25T11:56:27.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Docker部署\\",\\"image\\":[\\"https://alioss.timecho.com/docs/img/%E5%BC%80%E6%BA%90-%E6%8B%89%E5%8F%96%E9%95%9C%E5%83%8F.PNG\\",\\"https://alioss.timecho.com/docs/img/%E5%BC%80%E6%BA%90-%E9%AA%8C%E8%AF%81%E9%83%A8%E7%BD%B2.png\\",\\"https://alioss.timecho.com/docs/img/%E5%BC%80%E6%BA%90-%E9%AA%8C%E8%AF%81%E9%83%A8%E7%BD%B22.png\\",\\"https://alioss.timecho.com/docs/img/%E5%BC%80%E6%BA%90-%E9%AA%8C%E8%AF%81%E9%83%A8%E7%BD%B23.png\\",\\"https://alioss.timecho.com/docs/img/%E5%BC%80%E6%BA%90-%E9%9B%86%E7%BE%A4%E7%89%881.png\\",\\"https://alioss.timecho.com/docs/img/%E5%BC%80%E6%BA%90-%E9%9B%86%E7%BE%A4%E7%89%882.png\\",\\"https://alioss.timecho.com/docs/img/%E5%BC%80%E6%BA%90-%E9%9B%86%E7%BE%A4%E7%89%883.png\\",\\"https://alioss.timecho.com/docs/img/%E5%BC%80%E6%BA%90-%E9%9B%86%E7%BE%A4%E7%89%884.png\\",\\"https://alioss.timecho.com/docs/img/%E5%BC%80%E6%BA%90-%E9%9B%86%E7%BE%A4%E7%89%885.png\\"],\\"dateModified\\":\\"2024-12-25T11:56:27.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"环境准备","slug":"环境准备","link":"#环境准备","children":[{"level":3,"title":"Docker安装","slug":"docker安装","link":"#docker安装","children":[]},{"level":3,"title":"docker-compose安装","slug":"docker-compose安装","link":"#docker-compose安装","children":[]}]},{"level":2,"title":"单机版","slug":"单机版","link":"#单机版","children":[{"level":3,"title":"拉取镜像文件","slug":"拉取镜像文件","link":"#拉取镜像文件","children":[]},{"level":3,"title":"创建docker bridge网络","slug":"创建docker-bridge网络","link":"#创建docker-bridge网络","children":[]},{"level":3,"title":"编写docker-compose的yml文件","slug":"编写docker-compose的yml文件","link":"#编写docker-compose的yml文件","children":[]},{"level":3,"title":"启动IoTDB","slug":"启动iotdb","link":"#启动iotdb","children":[]},{"level":3,"title":"验证部署","slug":"验证部署","link":"#验证部署","children":[]},{"level":3,"title":"映射/conf目录(可选)","slug":"映射-conf目录-可选","link":"#映射-conf目录-可选","children":[]}]},{"level":2,"title":"集群版","slug":"集群版","link":"#集群版","children":[{"level":3,"title":"设置主机名","slug":"设置主机名","link":"#设置主机名","children":[]},{"level":3,"title":"拉取镜像文件","slug":"拉取镜像文件-1","link":"#拉取镜像文件-1","children":[]},{"level":3,"title":"编写docker-compose的yml文件","slug":"编写docker-compose的yml文件-1","link":"#编写docker-compose的yml文件-1","children":[]},{"level":3,"title":"首次启动confignode","slug":"首次启动confignode","link":"#首次启动confignode","children":[]},{"level":3,"title":"启动datanode","slug":"启动datanode","link":"#启动datanode","children":[]},{"level":3,"title":"验证部署","slug":"验证部署-1","link":"#验证部署-1","children":[]},{"level":3,"title":"映射/conf目录(可选)","slug":"映射-conf目录-可选-1","link":"#映射-conf目录-可选-1","children":[]}]}],"git":{"createdTime":1723190680000,"updatedTime":1735127787000,"contributors":[{"name":"W1y1r","username":"W1y1r","email":"150988475+W1y1r@users.noreply.github.com","commits":2,"url":"https://github.com/W1y1r"},{"name":"majialin","username":"majialin","email":"107627937+mal117@users.noreply.github.com","commits":4,"url":"https://github.com/majialin"}]},"readingTime":{"minutes":6.74,"words":2021},"filePathRelative":"zh/UserGuide/V2.0.1/Tree/Deployment-and-Maintenance/Docker-Deployment_apache.md","localizedDate":"2024年8月9日","autoDesc":true}');export{t as comp,r as data};
