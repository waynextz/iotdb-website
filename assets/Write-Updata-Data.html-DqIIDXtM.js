import{_ as n,c as a,b as l,o}from"./app-Blz7MdAO.js";const p={};function e(t,s){return o(),a("div",null,s[0]||(s[0]=[l(`<h1 id="数据写入-更新" tabindex="-1"><a class="header-anchor" href="#数据写入-更新"><span>数据写入&amp;更新</span></a></h1><h2 id="_1-数据写入" tabindex="-1"><a class="header-anchor" href="#_1-数据写入"><span>1. 数据写入</span></a></h2><h3 id="_1-1-语法" tabindex="-1"><a class="header-anchor" href="#_1-1-语法"><span>1.1 语法</span></a></h3><p>在 IoTDB 中，数据写入遵循以下通用语法：</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">INSERT INTO</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#ABB2BF;">TABLE_NAME</span><span style="color:#56B6C2;">&gt;</span><span style="color:#E06C75;"> [(COLUMN_NAME[, COLUMN_NAME]</span><span style="color:#ABB2BF;">*)]? </span><span style="color:#C678DD;">VALUES</span><span style="color:#ABB2BF;"> (COLUMN_VALUE</span><span style="color:#E06C75;">[, COLUMN_VALUE]</span><span style="color:#ABB2BF;">*)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>基本约束包括：</p><ol><li>通过 insert 语句写入无法自动创建表。</li><li>未指定的标签列将自动填充为 <code>null</code>。</li><li>未包含时间戳，系统将使用当前时间 <code>now()</code> 进行填充。</li><li>若当前设备（由标识信息定位）不存在该属性列的值，执行写入操作将导致原有的空值（NULL）被写入的数据所替代。</li><li>若当前设备（由标识信息定位）已有属性列的值，再次写入相同的属性列时，系统将更新该属性列的值为新数据。</li><li>写入重复时间戳，原时间戳为null的列会被更新，原不为null的列，保留原来列的值。</li></ol><p>由于属性一般并不随时间的变化而变化，因此推荐以 update 的方式单独更新属性值，参见下文 <a href="#%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0">数据更新</a>。</p><div style="text-align:center;"><img src="https://alioss.timecho.com/docs/img/WriteData01.png" alt="" style="width:70%;"></div><h3 id="_1-2-通过-session-写入自动创建表" tabindex="-1"><a class="header-anchor" href="#_1-2-通过-session-写入自动创建表"><span>1.2 通过 Session 写入自动创建表</span></a></h3><p>在通过 Session 进行数据写入时，IoTDB 能够根据写入请求中的信息自动构建表结构，无需用户事先手动创建表即可直接执行数据写入操作。</p><p><strong>示例：</strong></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">try</span><span style="color:#E06C75;"> (</span><span style="color:#E5C07B;">ITableSession</span><span style="color:#E06C75;"> session </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#C678DD;">    new</span><span style="color:#61AFEF;"> TableSessionBuilder</span><span style="color:#E06C75;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        .</span><span style="color:#61AFEF;">nodeUrls</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Collections</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">singletonList</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;127.0.0.1:6667&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">        .</span><span style="color:#61AFEF;">username</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;root&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        .</span><span style="color:#61AFEF;">password</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;root&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        .</span><span style="color:#61AFEF;">build</span><span style="color:#ABB2BF;">()</span><span style="color:#E06C75;">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">  session</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">executeNonQueryStatement</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;CREATE DATABASE db1&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">  session</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">executeNonQueryStatement</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;use db1&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // 不创建表直接写入数据</span></span>
<span class="line"><span style="color:#E5C07B;">  List</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> columnNameList </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#E5C07B;">      Arrays</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">asList</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;region_id&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;plant_id&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;device_id&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;model&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;temperature&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;humidity&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">  List</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">TSDataType</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> dataTypeList </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#E5C07B;">      Arrays</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">asList</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">          TSDataType</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">STRING</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E5C07B;">          TSDataType</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">STRING</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E5C07B;">          TSDataType</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">STRING</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E5C07B;">          TSDataType</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">STRING</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E5C07B;">          TSDataType</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">FLOAT</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E5C07B;">          TSDataType</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">DOUBLE</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">  List</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">Tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">ColumnCategory</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> columnTypeList </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#C678DD;">      new</span><span style="color:#E5C07B;"> ArrayList</span><span style="color:#ABB2BF;">&lt;&gt;</span><span style="color:#E06C75;">(</span></span>
<span class="line"><span style="color:#E5C07B;">          Arrays</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">asList</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">              Tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">ColumnCategory</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">TAG</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E5C07B;">              Tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">ColumnCategory</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">TAG</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E5C07B;">              Tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">ColumnCategory</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">TAG</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E5C07B;">              Tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">ColumnCategory</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">ATTRIBUTE</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E5C07B;">              Tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">ColumnCategory</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">FIELD</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E5C07B;">              Tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">ColumnCategory</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">FIELD</span><span style="color:#ABB2BF;">)</span><span style="color:#E06C75;">)</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;">  Tablet</span><span style="color:#E06C75;"> tablet </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Tablet</span><span style="color:#E06C75;">(</span><span style="color:#98C379;">&quot;table1&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> columnNameList</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> dataTypeList</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> columnTypeList</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;"> 100</span><span style="color:#E06C75;">)</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">  for</span><span style="color:#E06C75;"> (</span><span style="color:#C678DD;">long</span><span style="color:#E06C75;"> timestamp </span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span><span style="color:#E06C75;"> timestamp </span><span style="color:#56B6C2;">&lt;</span><span style="color:#D19A66;"> 100</span><span style="color:#ABB2BF;">;</span><span style="color:#E06C75;"> timestamp</span><span style="color:#ABB2BF;">++</span><span style="color:#E06C75;">) {</span></span>
<span class="line"><span style="color:#C678DD;">    int</span><span style="color:#E06C75;"> rowIndex </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getRowSize</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">    tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addTimestamp</span><span style="color:#ABB2BF;">(rowIndex, timestamp);</span></span>
<span class="line"><span style="color:#E5C07B;">    tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addValue</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;region_id&quot;</span><span style="color:#ABB2BF;">, rowIndex, </span><span style="color:#98C379;">&quot;1&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">    tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addValue</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;plant_id&quot;</span><span style="color:#ABB2BF;">, rowIndex, </span><span style="color:#98C379;">&quot;5&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">    tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addValue</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;device_id&quot;</span><span style="color:#ABB2BF;">, rowIndex, </span><span style="color:#98C379;">&quot;3&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">    tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addValue</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;model&quot;</span><span style="color:#ABB2BF;">, rowIndex, </span><span style="color:#98C379;">&quot;A&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">    tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addValue</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;temperature&quot;</span><span style="color:#ABB2BF;">, rowIndex, </span><span style="color:#D19A66;">37.6F</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">    tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addValue</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;humidity&quot;</span><span style="color:#ABB2BF;">, rowIndex, </span><span style="color:#D19A66;">111.1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#E06C75;"> (</span><span style="color:#E5C07B;">tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getRowSize</span><span style="color:#ABB2BF;">()</span><span style="color:#56B6C2;"> ==</span><span style="color:#E5C07B;"> tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getMaxRowNumber</span><span style="color:#ABB2BF;">()</span><span style="color:#E06C75;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">      session</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">insert</span><span style="color:#ABB2BF;">(tablet);</span></span>
<span class="line"><span style="color:#E5C07B;">      tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">reset</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E06C75;">    }</span></span>
<span class="line"><span style="color:#E06C75;">  }</span></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#E06C75;"> (</span><span style="color:#E5C07B;">tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getRowSize</span><span style="color:#ABB2BF;">()</span><span style="color:#56B6C2;"> !=</span><span style="color:#D19A66;"> 0</span><span style="color:#E06C75;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">    session</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">insert</span><span style="color:#ABB2BF;">(tablet);</span></span>
<span class="line"><span style="color:#E5C07B;">    tablet</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">reset</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E06C75;">  }</span></span>
<span class="line"><span style="color:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在代码执行完成后，可以通过下述语句确认表已成功创建，其中包含了时间列、标签列、属性列以及测点列等各类信息。</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">IoTDB</span><span style="color:#56B6C2;">&gt;</span><span style="color:#C678DD;"> desc</span><span style="color:#ABB2BF;"> table1</span></span>
<span class="line"><span style="color:#ABB2BF;">+</span><span style="color:#7F848E;font-style:italic;">-----------+---------+-----------+</span></span>
<span class="line"><span style="color:#ABB2BF;">| ColumnName| DataType|   Category|</span></span>
<span class="line"><span style="color:#ABB2BF;">+</span><span style="color:#7F848E;font-style:italic;">-----------+---------+-----------+</span></span>
<span class="line"><span style="color:#ABB2BF;">|       </span><span style="color:#C678DD;">time</span><span style="color:#ABB2BF;">|</span><span style="color:#C678DD;">TIMESTAMP</span><span style="color:#ABB2BF;">|       </span><span style="color:#C678DD;">TIME</span><span style="color:#ABB2BF;">|</span></span>
<span class="line"><span style="color:#ABB2BF;">|  region_id|   STRING|        TAG|</span></span>
<span class="line"><span style="color:#ABB2BF;">|   plant_id|   STRING|        TAG|</span></span>
<span class="line"><span style="color:#ABB2BF;">|  device_id|   STRING|        TAG|</span></span>
<span class="line"><span style="color:#ABB2BF;">|      model|   STRING|  ATTRIBUTE|</span></span>
<span class="line"><span style="color:#ABB2BF;">|temperature|    </span><span style="color:#C678DD;">FLOAT</span><span style="color:#ABB2BF;">|      FIELD|</span></span>
<span class="line"><span style="color:#ABB2BF;">|   humidity|   DOUBLE|      FIELD|</span></span>
<span class="line"><span style="color:#ABB2BF;">+</span><span style="color:#7F848E;font-style:italic;">-----------+---------+-----------+</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-3-指定列写入" tabindex="-1"><a class="header-anchor" href="#_1-3-指定列写入"><span>1.3 指定列写入</span></a></h3><p>在写入操作中，可以指定部分列，未指定的列将不会被写入任何内容（即设置为 <code>null</code>）。</p><p><strong>示例：</strong></p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">insert into</span><span style="color:#ABB2BF;"> table1(</span><span style="color:#98C379;">&quot;地区&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;厂号&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;设备号&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">Time</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;温度&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;排量&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">values</span><span style="color:#ABB2BF;"> (</span><span style="color:#98C379;">&#39;湖南&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;3001&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;3&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">90</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1200</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">insert into</span><span style="color:#ABB2BF;"> table1(</span><span style="color:#98C379;">&quot;地区&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;厂号&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;设备号&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">Time</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;温度&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">values</span><span style="color:#ABB2BF;"> (</span><span style="color:#98C379;">&#39;湖南, &#39;</span><span style="color:#D19A66;">3001</span><span style="color:#98C379;">&#39;, &#39;</span><span style="color:#D19A66;">3</span><span style="color:#98C379;">&#39;, 5, 90.0)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-4-空值写入" tabindex="-1"><a class="header-anchor" href="#_1-4-空值写入"><span>1.4 空值写入</span></a></h3><p>标签列、属性列和测点列可以指定空值（<code>null</code>），表示不写入任何内容。</p><p><strong>示例（与上述事例等价）：</strong></p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;"># 上述部分列写入等价于如下的带空值写入</span></span>
<span class="line"><span style="color:#C678DD;">insert into</span><span style="color:#ABB2BF;"> table1(</span><span style="color:#98C379;">&quot;地区&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;厂号&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;设备号&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;型号&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;维修周期&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">Time</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;温度&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;排量&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">values</span><span style="color:#ABB2BF;"> (</span><span style="color:#98C379;">&#39;湖南&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;3001&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;3&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">null</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">null</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">90</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1200</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">insert into</span><span style="color:#ABB2BF;"> table1(</span><span style="color:#98C379;">&quot;地区&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;厂号&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;设备号&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;型号&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;维修周期&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">Time</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;温度&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;排量&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">values</span><span style="color:#ABB2BF;"> (</span><span style="color:#98C379;">&#39;湖南&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;3001&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;3&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">null</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">null</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">90</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">null</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当向不包含任何标签列的表中写入数据时，系统将默认创建一个所有标签列值均为 null 的device。</p><blockquote><p>注意，该操作不仅会自动为表中已有的标签列填充 null 值，而且对于未来新增的标签列，同样会自动填充 null。</p></blockquote><h3 id="_1-5-多行写入" tabindex="-1"><a class="header-anchor" href="#_1-5-多行写入"><span>1.5 多行写入</span></a></h3><p>支持同时写入多行数据，提高数据写入效率。</p><p><strong>示例：</strong></p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">insert into</span><span style="color:#ABB2BF;"> table1</span></span>
<span class="line"><span style="color:#C678DD;">values</span></span>
<span class="line"><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;北京&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;3001&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;3&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;1&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;10&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">90</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1200</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;北京&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;3001&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;3&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;1&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;10&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">90</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1200</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">insert into</span><span style="color:#ABB2BF;"> table1</span></span>
<span class="line"><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;地区&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;厂号&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;设备号&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">Time</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;温度&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;排量&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">values</span></span>
<span class="line"><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;北京&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;3001&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;3&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">90</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1200</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;北京&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;3001&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;3&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">90</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1200</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="注意事项" tabindex="-1"><a class="header-anchor" href="#注意事项"><span>注意事项</span></a></h4><ul><li>如果在 SQL 语句中引用了表中不存在的列，IoTDB 将返回错误码 <code>COLUMN_NOT_EXIST(616)</code>。</li><li>如果写入的数据类型与表中列的数据类型不一致，将报错 <code>DATA_TYPE_MISMATCH(614)</code>。</li></ul><h2 id="_2-数据更新" tabindex="-1"><a class="header-anchor" href="#_2-数据更新"><span>2. 数据更新</span></a></h2><h3 id="_2-1-语法" tabindex="-1"><a class="header-anchor" href="#_2-1-语法"><span>2.1 语法</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">UPDATE</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#ABB2BF;">TABLE_NAME</span><span style="color:#56B6C2;">&gt;</span><span style="color:#C678DD;"> SET</span><span style="color:#ABB2BF;"> updateAssignment (</span><span style="color:#98C379;">&#39;,&#39;</span><span style="color:#ABB2BF;"> updateAssignment)* (</span><span style="color:#C678DD;">WHERE</span><span style="color:#C678DD;"> where</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">booleanExpression)?</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">updateAssignment</span></span>
<span class="line"><span style="color:#ABB2BF;">    : identifier EQ expression</span></span>
<span class="line"><span style="color:#ABB2BF;">    ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li><code>update</code>语句仅允许修改属性（ATTRIBUTE）列的值。</li><li><code>WHERE</code> 的规则： <ul><li>范围仅限于标签列（TAG）和属性列（ATTRIBUTE），不允许涉及测点列（FIELD）和时间列（TIME）。</li><li>不允许使用聚合函数</li></ul></li><li>执行 SET 操作后，赋值表达式的结果应当是字符串类型，且其使用的限制应与 WHERE 子句中的表达式相同。</li><li>属性（ATTRIBUTE）列以及测点（FIELD）列的值也可通过<code>insert</code>语句来实现指定行的更新。</li></ol><p><strong>示例：</strong></p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">update</span><span style="color:#ABB2BF;"> table1 </span><span style="color:#C678DD;">set</span><span style="color:#ABB2BF;"> b </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> a </span><span style="color:#C678DD;">where</span><span style="color:#56B6C2;"> substring</span><span style="color:#ABB2BF;">(a, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">like</span><span style="color:#98C379;"> &#39;%&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,37)]))}const c=n(p,[["render",e],["__file","Write-Updata-Data.html.vue"]]),B=JSON.parse('{"path":"/zh/UserGuide/V2.0.1/Table/Basic-Concept/Write-Updata-Data.html","title":"数据写入&更新","lang":"zh-CN","frontmatter":{"description":"数据写入&更新 1. 数据写入 1.1 语法 在 IoTDB 中，数据写入遵循以下通用语法： 基本约束包括： 通过 insert 语句写入无法自动创建表。 未指定的标签列将自动填充为 null。 未包含时间戳，系统将使用当前时间 now() 进行填充。 若当前设备（由标识信息定位）不存在该属性列的值，执行写入操作将导致原有的空值（NULL）被写入的数据...","head":[["meta",{"property":"og:url","content":"https://iotdb.apache.org/zh/UserGuide/V2.0.1/Table/Basic-Concept/Write-Updata-Data.html"}],["meta",{"property":"og:site_name","content":"IoTDB Website"}],["meta",{"property":"og:title","content":"数据写入&更新"}],["meta",{"property":"og:description","content":"数据写入&更新 1. 数据写入 1.1 语法 在 IoTDB 中，数据写入遵循以下通用语法： 基本约束包括： 通过 insert 语句写入无法自动创建表。 未指定的标签列将自动填充为 null。 未包含时间戳，系统将使用当前时间 now() 进行填充。 若当前设备（由标识信息定位）不存在该属性列的值，执行写入操作将导致原有的空值（NULL）被写入的数据..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-01-07T02:47:26.000Z"}],["meta",{"property":"article:modified_time","content":"2025-01-07T02:47:26.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"数据写入&更新\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-01-07T02:47:26.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"1. 数据写入","slug":"_1-数据写入","link":"#_1-数据写入","children":[{"level":3,"title":"1.1 语法","slug":"_1-1-语法","link":"#_1-1-语法","children":[]},{"level":3,"title":"1.2 通过 Session 写入自动创建表","slug":"_1-2-通过-session-写入自动创建表","link":"#_1-2-通过-session-写入自动创建表","children":[]},{"level":3,"title":"1.3 指定列写入","slug":"_1-3-指定列写入","link":"#_1-3-指定列写入","children":[]},{"level":3,"title":"1.4 空值写入","slug":"_1-4-空值写入","link":"#_1-4-空值写入","children":[]},{"level":3,"title":"1.5 多行写入","slug":"_1-5-多行写入","link":"#_1-5-多行写入","children":[]}]},{"level":2,"title":"2. 数据更新","slug":"_2-数据更新","link":"#_2-数据更新","children":[{"level":3,"title":"2.1 语法","slug":"_2-1-语法","link":"#_2-1-语法","children":[]}]}],"git":{"createdTime":1735900165000,"updatedTime":1736218046000,"contributors":[{"name":"W1y1r","username":"W1y1r","email":"150988475+W1y1r@users.noreply.github.com","commits":2,"url":"https://github.com/W1y1r"}]},"readingTime":{"minutes":4.15,"words":1244},"filePathRelative":"zh/UserGuide/V2.0.1/Table/Basic-Concept/Write-Updata-Data.md","localizedDate":"2025年1月3日","autoDesc":true}');export{c as comp,B as data};
