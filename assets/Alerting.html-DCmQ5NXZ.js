import{_ as o,c as p,b as l,d as a,e as n,a as t,f as r,r as i,o as c}from"./app-Blz7MdAO.js";const B={};function d(y,s){const e=i("RouteLink");return c(),p("div",null,[s[7]||(s[7]=l(`<h1 id="alerting" tabindex="-1"><a class="header-anchor" href="#alerting"><span>Alerting</span></a></h1><h2 id="overview" tabindex="-1"><a class="header-anchor" href="#overview"><span>Overview</span></a></h2><p>The alerting of IoTDB is expected to support two modes:</p><ul><li><p>Writing triggered: the user writes data to the original time series, and every time a piece of data is inserted, the judgment logic of <code>trigger</code> will be triggered.<br> If the alerting requirements are met, an alert is sent to the data sink,<br> The data sink then forwards the alert to the external terminal.</p><ul><li>This mode is suitable for scenarios that need to monitor every piece of data in real time.</li><li>Since the operation in the trigger will affect the data writing performance, it is suitable for scenarios that are not sensitive to the original data writing performance.</li></ul></li><li><p>Continuous query: the user writes data to the original time series,<br><code>ContinousQuery</code> periodically queries the original time series, and writes the query results into the new time series,<br> Each write triggers the judgment logic of <code>trigger</code>,<br> If the alerting requirements are met, an alert is sent to the data sink,<br> The data sink then forwards the alert to the external terminal.</p><ul><li>This mode is suitable for scenarios where data needs to be regularly queried within a certain period of time.</li><li>It is Suitable for scenarios where the original data needs to be down-sampled and persisted.</li><li>Since the timing query hardly affects the writing of the original time series, it is suitable for scenarios that are sensitive to the performance of the original data writing performance.</li></ul></li></ul><p>With the introduction of the <code>trigger</code> module and the <code>sink</code> module into IoTDB,<br> at present, users can use these two modules with <code>AlertManager</code> to realize the writing triggered alerting mode.</p><h2 id="deploying-alertmanager" tabindex="-1"><a class="header-anchor" href="#deploying-alertmanager"><span>Deploying AlertManager</span></a></h2><h3 id="installation" tabindex="-1"><a class="header-anchor" href="#installation"><span>Installation</span></a></h3><h4 id="precompiled-binaries" tabindex="-1"><a class="header-anchor" href="#precompiled-binaries"><span>Precompiled binaries</span></a></h4><p>The pre-compiled binary file can be downloaded <a href="https://prometheus.io/download/" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Running command:</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#61AFEF;">./alertmanager</span><span style="color:#D19A66;"> --config.file=</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#D19A66;">your_file</span><span style="color:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="docker-image" tabindex="-1"><a class="header-anchor" href="#docker-image"><span>Docker image</span></a></h4><p>Available at <a href="https://hub.docker.com/r/prom/alertmanager/" target="_blank" rel="noopener noreferrer">Quay.io</a><br> or <a href="https://quay.io/repository/prometheus/alertmanager" target="_blank" rel="noopener noreferrer">Docker Hub</a>.</p><p>Running command:</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#61AFEF;">docker</span><span style="color:#98C379;"> run</span><span style="color:#D19A66;"> --name</span><span style="color:#98C379;"> alertmanager</span><span style="color:#D19A66;"> -d</span><span style="color:#D19A66;"> -p</span><span style="color:#98C379;"> 127.0.0.1:9093:9093</span><span style="color:#98C379;"> quay.io/prometheus/alertmanager</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="configuration" tabindex="-1"><a class="header-anchor" href="#configuration"><span>Configuration</span></a></h3><p>The following is an example, which can cover most of the configuration rules. For detailed configuration rules, see<br><a href="https://prometheus.io/docs/alerting/latest/configuration/" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Example:</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" data-title="yaml" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># alertmanager.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">global</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # The smarthost and SMTP sender used for mail notifications.</span></span>
<span class="line"><span style="color:#E06C75;">  smtp_smarthost</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;localhost:25&#39;</span></span>
<span class="line"><span style="color:#E06C75;">  smtp_from</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;alertmanager@example.org&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># The root route on which each incoming alert enters.</span></span>
<span class="line"><span style="color:#E06C75;">route</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # The root route must not have any matchers as it is the entry point for</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # all alerts. It needs to have a receiver configured so alerts that do not</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # match any of the sub-routes are sent to someone.</span></span>
<span class="line"><span style="color:#E06C75;">  receiver</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;team-X-mails&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # The labels by which incoming alerts are grouped together. For example,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # multiple alerts coming in for cluster=A and alertname=LatencyHigh would</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # be batched into a single group.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  #</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # To aggregate by all possible labels use &#39;...&#39; as the sole label name.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # This effectively disables aggregation entirely, passing through all</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # alerts as-is. This is unlikely to be what you want, unless you have</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # a very low alert volume or your upstream notification system performs</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # its own grouping. Example: group_by: [...]</span></span>
<span class="line"><span style="color:#E06C75;">  group_by</span><span style="color:#ABB2BF;">: [</span><span style="color:#98C379;">&#39;alertname&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;cluster&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # When a new group of alerts is created by an incoming alert, wait at</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # least &#39;group_wait&#39; to send the initial notification.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # This way ensures that you get multiple alerts for the same group that start</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # firing shortly after another are batched together on the first</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # notification.</span></span>
<span class="line"><span style="color:#E06C75;">  group_wait</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">30s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # When the first notification was sent, wait &#39;group_interval&#39; to send a batch</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # of new alerts that started firing for that group.</span></span>
<span class="line"><span style="color:#E06C75;">  group_interval</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">5m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # If an alert has successfully been sent, wait &#39;repeat_interval&#39; to</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # resend them.</span></span>
<span class="line"><span style="color:#E06C75;">  repeat_interval</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">3h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # All the above attributes are inherited by all child routes and can</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # overwritten on each.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # The child route trees.</span></span>
<span class="line"><span style="color:#E06C75;">  routes</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # This routes performs a regular expression match on alert labels to</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # catch alerts that are related to a list of services.</span></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">match_re</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">      service</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">^(foo1|foo2|baz)$</span></span>
<span class="line"><span style="color:#E06C75;">    receiver</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">team-X-mails</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # The service has a sub-route for critical alerts, any alerts</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # that do not match, i.e. severity != critical, fall-back to the</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # parent node and are sent to &#39;team-X-mails&#39;</span></span>
<span class="line"><span style="color:#E06C75;">    routes</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    - </span><span style="color:#E06C75;">match</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">        severity</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">critical</span></span>
<span class="line"><span style="color:#E06C75;">      receiver</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">team-X-pager</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">match</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">      service</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">files</span></span>
<span class="line"><span style="color:#E06C75;">    receiver</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">team-Y-mails</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">    routes</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    - </span><span style="color:#E06C75;">match</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">        severity</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">critical</span></span>
<span class="line"><span style="color:#E06C75;">      receiver</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">team-Y-pager</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # This route handles all alerts coming from a database service. If there&#39;s</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # no team to handle it, it defaults to the DB team.</span></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">match</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">      service</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">database</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">    receiver</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">team-DB-pager</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    # Also group alerts by affected database.</span></span>
<span class="line"><span style="color:#E06C75;">    group_by</span><span style="color:#ABB2BF;">: [</span><span style="color:#98C379;">alertname</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">cluster</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">database</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">    routes</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    - </span><span style="color:#E06C75;">match</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">        owner</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">team-X</span></span>
<span class="line"><span style="color:#E06C75;">      receiver</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">team-X-pager</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    - </span><span style="color:#E06C75;">match</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">        owner</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">team-Y</span></span>
<span class="line"><span style="color:#E06C75;">      receiver</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">team-Y-pager</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># Inhibition rules allow to mute a set of alerts given that another alert is</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># firing.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># We use this to mute any warning-level notifications if the same alert is</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># already critical.</span></span>
<span class="line"><span style="color:#E06C75;">inhibit_rules</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">- </span><span style="color:#E06C75;">source_match</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">    severity</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;critical&#39;</span></span>
<span class="line"><span style="color:#E06C75;">  target_match</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">    severity</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;warning&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # Apply inhibition if the alertname is the same.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  # CAUTION: </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  #   If all label names listed in \`equal\` are missing </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  #   from both the source and target alerts,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  #   the inhibition rule will apply!</span></span>
<span class="line"><span style="color:#E06C75;">  equal</span><span style="color:#ABB2BF;">: [</span><span style="color:#98C379;">&#39;alertname&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">receivers</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">- </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;team-X-mails&#39;</span></span>
<span class="line"><span style="color:#E06C75;">  email_configs</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">to</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;team-X+alerts@example.org, team-Y+alerts@example.org&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">- </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;team-X-pager&#39;</span></span>
<span class="line"><span style="color:#E06C75;">  email_configs</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">to</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;team-X+alerts-critical@example.org&#39;</span></span>
<span class="line"><span style="color:#E06C75;">  pagerduty_configs</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">routing_key</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&lt;team-X-key&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">- </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;team-Y-mails&#39;</span></span>
<span class="line"><span style="color:#E06C75;">  email_configs</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">to</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;team-Y+alerts@example.org&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">- </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;team-Y-pager&#39;</span></span>
<span class="line"><span style="color:#E06C75;">  pagerduty_configs</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">routing_key</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&lt;team-Y-key&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">- </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;team-DB-pager&#39;</span></span>
<span class="line"><span style="color:#E06C75;">  pagerduty_configs</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">routing_key</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&lt;team-DB-key&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In the following example, we used the following configuration:</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" data-title="yaml" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># alertmanager.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">global</span><span style="color:#ABB2BF;">: </span></span>
<span class="line"><span style="color:#E06C75;">  smtp_smarthost</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span></span>
<span class="line"><span style="color:#E06C75;">  smtp_from</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#E06C75;">  smtp_auth_username</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#E06C75;">  smtp_auth_password</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#E06C75;">  smtp_require_tls</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">route</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">  group_by</span><span style="color:#ABB2BF;">: [</span><span style="color:#98C379;">&#39;alertname&#39;</span><span style="color:#ABB2BF;">] </span></span>
<span class="line"><span style="color:#E06C75;">  group_wait</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">1m</span></span>
<span class="line"><span style="color:#E06C75;">  group_interval</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">10m</span></span>
<span class="line"><span style="color:#E06C75;">  repeat_interval</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">10h</span><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#E06C75;">  receiver</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;email&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">receivers</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;email&#39;</span></span>
<span class="line"><span style="color:#E06C75;">    email_configs</span><span style="color:#ABB2BF;">: </span></span>
<span class="line"><span style="color:#ABB2BF;">    - </span><span style="color:#E06C75;">to</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">inhibit_rules</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">source_match</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">      severity</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;critical&#39;</span></span>
<span class="line"><span style="color:#E06C75;">    target_match</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">      severity</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;warning&#39;</span></span>
<span class="line"><span style="color:#E06C75;">    equal</span><span style="color:#ABB2BF;">: [</span><span style="color:#98C379;">&#39;alertname&#39;</span><span style="color:#ABB2BF;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="api" tabindex="-1"><a class="header-anchor" href="#api"><span>API</span></a></h3><p>The <code>AlertManager</code> API is divided into two versions, <code>v1</code> and <code>v2</code>. The current <code>AlertManager</code> API version is <code>v2</code><br> (For configuration see<br><a href="https://github.com/prometheus/alertmanager/blob/master/api/v2/openapi.yaml" target="_blank" rel="noopener noreferrer">api/v2/openapi.yaml</a>).</p><p>By default, the prefix is <code>/api/v1</code> or <code>/api/v2</code> and the endpoint for sending alerts is <code>/api/v1/alerts</code> or <code>/api/v2/alerts</code>.<br> If the user specifies <code>--web.route-prefix</code>,<br> for example <code>--web.route-prefix=/alertmanager/</code>,<br> then the prefix will become <code>/alertmanager/api/v1</code> or <code>/alertmanager/api/v2</code>,<br> and the endpoint that sends the alert becomes <code>/alertmanager/api/v1/alerts</code><br> or <code>/alertmanager/api/v2/alerts</code>.</p><h2 id="creating-trigger" tabindex="-1"><a class="header-anchor" href="#creating-trigger"><span>Creating trigger</span></a></h2><h3 id="writing-the-trigger-class" tabindex="-1"><a class="header-anchor" href="#writing-the-trigger-class"><span>Writing the trigger class</span></a></h3>`,26)),a("p",null,[s[1]||(s[1]=n("The user defines a trigger by creating a Java class and writing the logic in the hook.")),s[2]||(s[2]=a("br",null,null,-1)),s[3]||(s[3]=n(" Please refer to ")),t(e,{to:"/UserGuide/V0.13.x/Process-Data/Triggers.html"},{default:r(()=>s[0]||(s[0]=[n("Triggers")])),_:1}),s[4]||(s[4]=n(" for the specific configuration process and the usage method of ")),s[5]||(s[5]=a("code",null,"AlertManagerSink",-1)),s[6]||(s[6]=n(" related tools provided by the Sink module."))]),s[8]||(s[8]=l(`<p>The following example creates the <code>org.apache.iotdb.trigger.AlertingExample</code> class,<br> Its alertManagerHandler member variables can send alerts to the AlertManager instance<br> at the address of <code>http://127.0.0.1:9093/</code>.</p><p>When <code>value&gt; 100.0</code>, send an alert of <code>critical</code> severity;<br> when <code>50.0 &lt;value &lt;= 100.0</code>, send an alert of <code>warning</code> severity<br> .</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">package</span><span style="color:#C678DD;"> org.apache.iotdb.trigger</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">package importing is omitted here</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">*/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#C678DD;"> class</span><span style="color:#E5C07B;"> AlertingExample</span><span style="color:#C678DD;"> implements</span><span style="color:#E5C07B;"> Trigger</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">  private</span><span style="color:#C678DD;"> final</span><span style="color:#E5C07B;"> AlertManagerHandler</span><span style="color:#E06C75;"> alertManagerHandler </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> AlertManagerHandler</span><span style="color:#E06C75;">()</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">  private</span><span style="color:#C678DD;"> final</span><span style="color:#E5C07B;"> AlertManagerConfiguration</span><span style="color:#E06C75;"> alertManagerConfiguration </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#C678DD;">      new</span><span style="color:#61AFEF;"> AlertManagerConfiguration</span><span style="color:#E06C75;">(</span><span style="color:#98C379;">&quot;http://127.0.0.1:9093/api/v2/alerts&quot;</span><span style="color:#E06C75;">)</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">  private</span><span style="color:#E5C07B;"> String</span><span style="color:#E06C75;"> alertname</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">  private</span><span style="color:#C678DD;"> final</span><span style="color:#E5C07B;"> HashMap</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;">,</span><span style="color:#E5C07B;"> String</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> labels </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> HashMap</span><span style="color:#ABB2BF;">&lt;&gt;</span><span style="color:#E06C75;">()</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">  private</span><span style="color:#C678DD;"> final</span><span style="color:#E5C07B;"> HashMap</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;">,</span><span style="color:#E5C07B;"> String</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> annotations </span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> HashMap</span><span style="color:#ABB2BF;">&lt;&gt;</span><span style="color:#E06C75;">()</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  @</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">  public</span><span style="color:#C678DD;"> void</span><span style="color:#61AFEF;"> onCreate</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">TriggerAttributes</span><span style="color:#E06C75;font-style:italic;"> attributes</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">    alertManagerHandler</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">(alertManagerConfiguration);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    alertname </span><span style="color:#56B6C2;">=</span><span style="color:#98C379;"> &quot;alert_test&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">    labels</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;series&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;root.ln.wf01.wt01.temperature&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">    labels</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">    labels</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;severity&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">    annotations</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;summary&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;high temperature&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">    annotations</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;description&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;{{.alertname}}: {{.series}} is {{.value}}&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  @</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">  public</span><span style="color:#C678DD;"> void</span><span style="color:#61AFEF;"> onDrop</span><span style="color:#ABB2BF;">()</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> IOException</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">    alertManagerHandler</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">close</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  @</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">  public</span><span style="color:#C678DD;"> void</span><span style="color:#61AFEF;"> onStart</span><span style="color:#ABB2BF;">()</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">    alertManagerHandler</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">(alertManagerConfiguration);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  @</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">  public</span><span style="color:#C678DD;"> void</span><span style="color:#61AFEF;"> onStop</span><span style="color:#ABB2BF;">()</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">    alertManagerHandler</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">close</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  @</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">  public</span><span style="color:#E5C07B;"> Double</span><span style="color:#61AFEF;"> fire</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">long</span><span style="color:#E06C75;font-style:italic;"> timestamp</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">Double</span><span style="color:#E06C75;font-style:italic;"> value</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (value </span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;"> 100.0</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">      labels</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">valueOf</span><span style="color:#ABB2BF;">(value));</span></span>
<span class="line"><span style="color:#E5C07B;">      labels</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;severity&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;critical&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">      AlertManagerEvent</span><span style="color:#E06C75;"> alertManagerEvent</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> AlertManagerEvent</span><span style="color:#ABB2BF;">(alertname, labels, annotations);</span></span>
<span class="line"><span style="color:#E5C07B;">      alertManagerHandler</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">onEvent</span><span style="color:#ABB2BF;">(alertManagerEvent);</span></span>
<span class="line"><span style="color:#ABB2BF;">    } </span><span style="color:#C678DD;">else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (value </span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;"> 50.0</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">      labels</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">valueOf</span><span style="color:#ABB2BF;">(value));</span></span>
<span class="line"><span style="color:#E5C07B;">      labels</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;severity&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;warning&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">      AlertManagerEvent</span><span style="color:#E06C75;"> alertManagerEvent</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> AlertManagerEvent</span><span style="color:#ABB2BF;">(alertname, labels, annotations);</span></span>
<span class="line"><span style="color:#E5C07B;">      alertManagerHandler</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">onEvent</span><span style="color:#ABB2BF;">(alertManagerEvent);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> value;</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  @</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">  public</span><span style="color:#C678DD;"> double</span><span style="color:#61AFEF;">[] fire</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">long</span><span style="color:#ABB2BF;">[] </span><span style="color:#E06C75;font-style:italic;">timestamps</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">double</span><span style="color:#ABB2BF;">[] </span><span style="color:#E06C75;font-style:italic;">values</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">double</span><span style="color:#E06C75;"> value</span><span style="color:#C678DD;"> :</span><span style="color:#ABB2BF;"> values) {</span></span>
<span class="line"><span style="color:#C678DD;">      if</span><span style="color:#ABB2BF;"> (value </span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;"> 100.0</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">        labels</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">valueOf</span><span style="color:#ABB2BF;">(value));</span></span>
<span class="line"><span style="color:#E5C07B;">        labels</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;severity&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;critical&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">        AlertManagerEvent</span><span style="color:#E06C75;"> alertManagerEvent</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> AlertManagerEvent</span><span style="color:#ABB2BF;">(alertname, labels, annotations);</span></span>
<span class="line"><span style="color:#E5C07B;">        alertManagerHandler</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">onEvent</span><span style="color:#ABB2BF;">(alertManagerEvent);</span></span>
<span class="line"><span style="color:#ABB2BF;">      } </span><span style="color:#C678DD;">else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (value </span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;"> 50.0</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">        labels</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">valueOf</span><span style="color:#ABB2BF;">(value));</span></span>
<span class="line"><span style="color:#E5C07B;">        labels</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;severity&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;warning&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">        AlertManagerEvent</span><span style="color:#E06C75;"> alertManagerEvent</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> AlertManagerEvent</span><span style="color:#ABB2BF;">(alertname, labels, annotations);</span></span>
<span class="line"><span style="color:#E5C07B;">        alertManagerHandler</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">onEvent</span><span style="color:#ABB2BF;">(alertManagerEvent);</span></span>
<span class="line"><span style="color:#ABB2BF;">      }</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> values;</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="creating-trigger-1" tabindex="-1"><a class="header-anchor" href="#creating-trigger-1"><span>Creating trigger</span></a></h3><p>The following SQL statement registered the trigger<br> named <code>root-ln-wf01-wt01-alert</code><br> on the <code>root.ln.wf01.wt01.temperature</code> time series,<br> whose operation logic is defined<br> by <code>org.apache.iotdb.trigger.AlertingExample</code> java class.</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">  CREATE</span><span style="color:#ABB2BF;"> TRIGGER </span><span style="color:#98C379;">\`root-ln-wf01-wt01-alert\`</span></span>
<span class="line"><span style="color:#C678DD;">  AFTER</span><span style="color:#C678DD;"> INSERT</span></span>
<span class="line"><span style="color:#C678DD;">  ON</span><span style="color:#D19A66;"> root</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">ln</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">wf01</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">wt01</span><span style="color:#ABB2BF;">.temperature</span></span>
<span class="line"><span style="color:#C678DD;">  AS</span><span style="color:#98C379;"> &quot;org.apache.iotdb.trigger.AlertingExample&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="writing-data" tabindex="-1"><a class="header-anchor" href="#writing-data"><span>Writing data</span></a></h2><p>When we finish the deployment and startup of AlertManager as well as the creation of Trigger,<br> we can test the alerting<br> by writing data to the time series.</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">INSERT INTO</span><span style="color:#D19A66;"> root</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">ln</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">wf01</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">wt01</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">timestamp</span><span style="color:#ABB2BF;">, temperature) </span><span style="color:#C678DD;">VALUES</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">INSERT INTO</span><span style="color:#D19A66;"> root</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">ln</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">wf01</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">wt01</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">timestamp</span><span style="color:#ABB2BF;">, temperature) </span><span style="color:#C678DD;">VALUES</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">30</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">INSERT INTO</span><span style="color:#D19A66;"> root</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">ln</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">wf01</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">wt01</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">timestamp</span><span style="color:#ABB2BF;">, temperature) </span><span style="color:#C678DD;">VALUES</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">60</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">INSERT INTO</span><span style="color:#D19A66;"> root</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">ln</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">wf01</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">wt01</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">timestamp</span><span style="color:#ABB2BF;">, temperature) </span><span style="color:#C678DD;">VALUES</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">90</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">INSERT INTO</span><span style="color:#D19A66;"> root</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">ln</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">wf01</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">wt01</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">timestamp</span><span style="color:#ABB2BF;">, temperature) </span><span style="color:#C678DD;">VALUES</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">120</span><span style="color:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>After executing the above writing statements,<br> we can receive an alerting email. Because our <code>AlertManager</code> configuration above<br> makes alerts of <code>critical</code> severity inhibit those of <code>warning</code> severity,<br> the alerting email we receive only contains the alert triggered<br> by the writing of <code>(5, 120)</code>.</p><img width="669" alt="alerting" src="https://alioss.timecho.com/docs/img/github/115957896-a9791080-a537-11eb-9962-541412bdcee6.png">`,11))])}const u=o(B,[["render",d],["__file","Alerting.html.vue"]]),m=JSON.parse('{"path":"/UserGuide/V0.13.x/Process-Data/Alerting.html","title":"Alerting","lang":"en-US","frontmatter":{"description":"Alerting Overview The alerting of IoTDB is expected to support two modes: Writing triggered: the user writes data to the original time series, and every time a piece of data is ...","head":[["link",{"rel":"alternate","hreflang":"zh-cn","href":"https://iotdb.apache.org/zh/UserGuide/V0.13.x/Process-Data/Alerting.html"}],["meta",{"property":"og:url","content":"https://iotdb.apache.org/UserGuide/V0.13.x/Process-Data/Alerting.html"}],["meta",{"property":"og:site_name","content":"IoTDB Website"}],["meta",{"property":"og:title","content":"Alerting"}],["meta",{"property":"og:description","content":"Alerting Overview The alerting of IoTDB is expected to support two modes: Writing triggered: the user writes data to the original time series, and every time a piece of data is ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:locale:alternate","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-07-10T03:11:17.000Z"}],["meta",{"property":"article:modified_time","content":"2023-07-10T03:11:17.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Alerting\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2023-07-10T03:11:17.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"Overview","slug":"overview","link":"#overview","children":[]},{"level":2,"title":"Deploying AlertManager","slug":"deploying-alertmanager","link":"#deploying-alertmanager","children":[{"level":3,"title":"Installation","slug":"installation","link":"#installation","children":[]},{"level":3,"title":"Configuration","slug":"configuration","link":"#configuration","children":[]},{"level":3,"title":"API","slug":"api","link":"#api","children":[]}]},{"level":2,"title":"Creating trigger","slug":"creating-trigger","link":"#creating-trigger","children":[{"level":3,"title":"Writing the trigger class","slug":"writing-the-trigger-class","link":"#writing-the-trigger-class","children":[]},{"level":3,"title":"Creating trigger","slug":"creating-trigger-1","link":"#creating-trigger-1","children":[]}]},{"level":2,"title":"Writing data","slug":"writing-data","link":"#writing-data","children":[]}],"git":{"createdTime":1688958677000,"updatedTime":1688958677000,"contributors":[{"name":"CritasWang","username":"CritasWang","email":"critas@outlook.com","commits":1,"url":"https://github.com/CritasWang"}]},"readingTime":{"minutes":5.21,"words":1564},"filePathRelative":"UserGuide/V0.13.x/Process-Data/Alerting.md","localizedDate":"July 10, 2023","autoDesc":true}');export{u as comp,m as data};
